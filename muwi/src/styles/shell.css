.muwi-titlebar {
  height: var(--space-titlebar-height);
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding-inline: var(--space-4);
  background: var(--color-bg-secondary);
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  line-height: var(--leading-snug);
  letter-spacing: var(--tracking-wide);
  -webkit-app-region: drag;
  user-select: none;
}

.muwi-titlebar__label {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.muwi-sidebar-shell {
  width: var(--space-sidebar-width);
  min-width: 0;
  flex-shrink: 0;
  transition: var(--transition-sidebar);
}

.muwi-sidebar-shell[data-open='false'] {
  width: 0;
}

.muwi-sidebar {
  height: 100%;
  width: var(--space-sidebar-width);
  background: var(--color-bg-secondary);
  border-right: 1px solid var(--color-border-default);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  transition: var(--transition-sidebar);
}

.muwi-sidebar-shell[data-open='false'] .muwi-sidebar {
  transform: translateX(calc(-1 * var(--space-sidebar-width)));
  opacity: 0;
  pointer-events: none;
}

.muwi-sidebar__header {
  min-height: var(--space-toolbar-height);
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: var(--space-2);
  padding-inline: var(--space-2);
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-sidebar__title {
  font-size: var(--font-size-md);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.muwi-sidebar__slot {
  padding: var(--space-2);
  border-bottom: 1px solid var(--color-border-subtle);
}

.muwi-sidebar__body {
  padding: var(--space-2);
  overflow: auto;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  flex: 1;
}

.muwi-sidebar__footer {
  border-top: 1px solid var(--color-border-default);
  padding: var(--space-2);
}

.muwi-sidebar-button {
  border: 0;
  background: transparent;
  color: var(--color-text-secondary);
  min-height: 28px;
  min-width: 28px;
  border-radius: var(--radius-sm);
  padding: var(--space-1);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  transition: var(--transition-colors);
}

.muwi-sidebar-button:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-sidebar-button:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-sidebar-item {
  min-height: 32px;
  width: 100%;
  border: 0;
  border-radius: var(--radius-sm);
  padding: var(--space-1) var(--space-3);
  background: transparent;
  color: var(--color-text-secondary);
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-sm);
  font-weight: var(--weight-regular);
  text-align: left;
  transition: var(--transition-colors);
}

.muwi-sidebar-item:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-sidebar-item.is-active {
  background: var(--color-selected-bg);
  color: var(--color-text-primary);
  font-weight: var(--weight-medium);
}

.muwi-sidebar-item__label {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1;
}

.muwi-drafts-list {
  height: 100%;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.muwi-drafts-list__scroll {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  padding-block: var(--space-1);
}

.muwi-drafts-list__item {
  min-height: 0;
  padding: var(--space-2) var(--space-3);
  align-items: stretch;
}

.muwi-drafts-list__item:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-drafts-list__item-content {
  min-width: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.muwi-drafts-list__item-head {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-drafts-list__item-title {
  margin: 0;
  min-width: 0;
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: var(--font-size-sm);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-drafts-list__item-preview {
  margin: 0;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  color: var(--color-text-secondary);
  font-size: var(--font-size-xs);
}

.muwi-drafts-list__item-meta {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-drafts-list__item-word-count,
.muwi-drafts-list__item-date {
  font-size: 11px;
  color: var(--color-text-tertiary);
}

.muwi-drafts-list__item-date {
  margin-left: auto;
}

.muwi-longdrafts-toolbar {
  width: 100%;
  min-width: 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
  color: var(--color-text-secondary);
}

.muwi-longdrafts-toolbar__group {
  min-width: 0;
  display: flex;
  align-items: center;
}

.muwi-longdrafts-toolbar__group .muwi-toolbar {
  min-height: 0;
  width: auto;
  border: 0;
  padding-inline: 0;
  background: transparent;
  overflow: visible;
}

.muwi-longdrafts-toolbar__meta {
  min-width: 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
  overflow-x: auto;
  overflow-y: hidden;
}

.muwi-longdrafts-toolbar__meta > span {
  white-space: nowrap;
}

.muwi-longdrafts-toc {
  height: 100%;
  min-height: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.muwi-longdrafts-toc.is-collapsed {
  align-items: center;
  justify-content: flex-start;
  padding-top: var(--space-2);
}

.muwi-longdrafts-toc__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
}

.muwi-longdrafts-toc__title {
  font-size: var(--font-size-sm);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-longdrafts-toc__toolbar-row {
  display: flex;
}

.muwi-longdrafts-toc__tree {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.muwi-longdrafts-toc__empty {
  padding: var(--space-4) var(--space-2);
  text-align: center;
  color: var(--color-text-tertiary);
  font-size: var(--font-size-xs);
  display: grid;
  gap: var(--space-1);
}

.muwi-longdrafts-toc__empty p {
  margin: 0;
}

.muwi-longdrafts-toc__item {
  min-height: 30px;
  padding-right: var(--space-2);
}

.muwi-longdrafts-toc__item.is-dragging {
  opacity: 0.6;
}

.muwi-longdrafts-toc__item.is-drop-target {
  background: color-mix(in srgb, var(--color-accent-default) 14%, transparent);
  outline: 1px dashed color-mix(in srgb, var(--color-accent-default) 55%, transparent);
}

.muwi-longdrafts-toc__drag-handle {
  color: var(--color-text-tertiary);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.muwi-longdrafts-toc__expand,
.muwi-longdrafts-toc__expand-placeholder {
  width: 14px;
  height: 14px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.muwi-longdrafts-toc__expand {
  border: 0;
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--color-text-tertiary);
  padding: 0;
}

.muwi-longdrafts-toc__expand:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-longdrafts-toc__status-dot {
  width: 8px;
  height: 8px;
  border-radius: 999px;
  flex-shrink: 0;
}

.muwi-longdrafts-toc__item-label {
  min-width: 0;
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.muwi-longdrafts-toc__item-count {
  font-size: 11px;
  color: var(--color-text-tertiary);
  flex-shrink: 0;
}

.muwi-longdrafts-toc__footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
  padding-top: var(--space-1);
  border-top: 1px solid var(--color-border-subtle);
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-longdrafts-editor__toolbar .muwi-toolbar {
  border-top: 1px solid var(--color-border-default);
  border-bottom: none;
}

.muwi-longdrafts-settings {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  padding: var(--space-2);
}

.muwi-longdrafts-settings__copy {
  margin: 0;
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-longdrafts-settings__toggle-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-academic-toolbar {
  width: 100%;
  min-width: 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-academic-toolbar__group {
  min-width: 0;
  flex: 1;
  display: flex;
}

.muwi-academic-toolbar__group .muwi-toolbar {
  min-height: 0;
  width: auto;
  border: 0;
  padding-inline: 0;
  background: transparent;
  overflow: visible;
}

.muwi-academic-toolbar__meta {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
  overflow: auto;
}

.muwi-academic-toolbar__meta > span {
  white-space: nowrap;
}

.muwi-academic-sidebar {
  height: 100%;
  min-height: 0;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.muwi-academic-sidebar__section {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.muwi-academic-sidebar__section--fill {
  flex: 1;
  min-height: 0;
  overflow: auto;
}

.muwi-academic-sidebar__paper-select {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.muwi-academic-sidebar__label,
.muwi-academic-sidebar__heading {
  font-size: var(--font-size-xs);
  font-weight: var(--weight-semibold);
  color: var(--color-text-tertiary);
  letter-spacing: var(--tracking-wide);
}

.muwi-academic-sidebar__empty {
  color: var(--color-text-tertiary);
  font-size: var(--font-size-xs);
  padding: var(--space-2);
}

.muwi-academic-sidebar__additional {
  margin-top: var(--space-2);
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.muwi-academic-structure-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.muwi-academic-structure-list__item {
  gap: var(--space-1);
}

.muwi-academic-structure-list__status {
  width: 7px;
  height: 7px;
  border-radius: 999px;
  background: var(--color-border-default);
  flex-shrink: 0;
}

.muwi-academic-structure-list__status[data-complete='true'] {
  background: var(--color-accent-default);
}

.muwi-academic-structure-list__tag {
  font-size: 11px;
  color: var(--color-text-tertiary);
  flex-shrink: 0;
}

.muwi-academic-sidebar__actions {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.muwi-academic-section-item {
  min-height: 30px;
  padding-right: var(--space-1);
  gap: var(--space-1);
}

.muwi-academic-section-item__main {
  flex: 1;
  min-width: 0;
  border: 0;
  background: transparent;
  color: inherit;
  display: flex;
  align-items: center;
  gap: var(--space-1);
  text-align: left;
  padding: 0;
}

.muwi-academic-section-item__count {
  font-size: 11px;
  color: var(--color-text-tertiary);
  flex-shrink: 0;
}

.muwi-academic-section-item__delete {
  border: 0;
  background: transparent;
  color: var(--color-text-tertiary);
  border-radius: var(--radius-sm);
  width: 20px;
  height: 20px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.muwi-academic-section-item__delete:hover {
  background: var(--color-hover-overlay);
  color: var(--color-error);
}

.muwi-academic-state {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  color: var(--color-text-secondary);
  text-align: center;
}

.muwi-academic-state[data-tone='error'] {
  color: var(--color-error);
}

.muwi-academic-state__spinner {
  width: 26px;
  height: 26px;
  border-radius: 999px;
  border: 2px solid var(--color-border-default);
  border-top-color: var(--color-accent-default);
  animation: muwi-academic-spin 900ms linear infinite;
}

@keyframes muwi-academic-spin {
  to {
    transform: rotate(360deg);
  }
}

.muwi-academic-panel {
  height: 100%;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.muwi-academic-panel__controls {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  padding: var(--space-2);
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-academic-panel__controls > label {
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
}

.muwi-academic-panel__content {
  flex: 1;
  min-height: 0;
}

.muwi-academic-editor {
  height: 100%;
  min-height: 0;
  display: flex;
  flex-direction: column;
  background: var(--color-bg-primary);
}

.muwi-academic-editor__header {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  padding: var(--space-4) var(--space-5) var(--space-3);
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-academic-editor__title {
  width: 100%;
  border: 0;
  outline: none;
  background: transparent;
  color: var(--color-text-primary);
  font-size: 22px;
  font-weight: var(--weight-semibold);
  font-family: var(--font-family-content-serif);
}

.muwi-academic-editor__metrics {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  flex-wrap: wrap;
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
}

.muwi-academic-editor__metrics kbd {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-height: 18px;
  padding-inline: var(--space-1);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-sm);
  background: var(--color-bg-secondary);
  color: var(--color-text-tertiary);
  font-size: 11px;
}

.muwi-academic-editor__toolbar {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: var(--space-1);
  padding: var(--space-2) var(--space-4);
  border-bottom: 1px solid var(--color-border-default);
  background: var(--color-bg-primary);
}

.muwi-academic-editor__toolbar-controls {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  flex-wrap: wrap;
}

.muwi-academic-editor__toolbar-controls label {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
}

.muwi-academic-editor__xref-panel {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-secondary);
  margin-left: var(--space-1);
}

.muwi-academic-editor__xref-panel > span {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-academic-editor__canvas {
  flex: 1;
  min-height: 0;
  overflow: auto;
  background: var(--color-bg-canvas);
  padding: var(--space-4);
}

.muwi-academic-editor__page-wrap {
  min-height: 100%;
  display: flex;
  justify-content: center;
}

.muwi-academic-editor__page {
  width: 100%;
  min-height: 100%;
  background: var(--color-bg-primary);
  border: 1px solid var(--color-border-default);
  box-shadow: var(--shadow-sm);
  display: flex;
  flex-direction: column;
}

.muwi-academic-editor__zone {
  min-height: 30px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 11px;
  color: var(--color-text-tertiary);
  border-bottom: 1px dashed var(--color-border-subtle);
  background: color-mix(in srgb, var(--color-bg-secondary) 75%, transparent);
}

.muwi-academic-editor__page footer.muwi-academic-editor__zone,
.muwi-academic-editor__zone:last-child {
  border-top: 1px dashed var(--color-border-subtle);
  border-bottom: none;
}

.muwi-academic-editor__page-content {
  flex: 1;
  min-height: 0;
}

.muwi-academic-editor__page-content .ProseMirror {
  min-height: 100%;
}

.muwi-academic-editor__empty {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--space-3);
  color: var(--color-text-tertiary);
  background: var(--color-bg-secondary);
}

.muwi-academic-editor__empty p {
  margin: 0;
  font-size: var(--font-size-base);
}

.muwi-academic-editor--focus {
  background: var(--color-bg-primary);
}

.muwi-academic-editor__focus-surface {
  flex: 1;
  min-height: 0;
  overflow: auto;
  margin-inline: auto;
  width: 100%;
  max-width: 720px;
  padding: 72px var(--space-6);
}

.muwi-academic-editor__focus-title {
  width: 100%;
  border: 0;
  outline: none;
  background: transparent;
  color: var(--color-text-primary);
  font-size: 24px;
  font-weight: var(--weight-bold);
  text-align: center;
  font-family: var(--font-family-content-serif);
  margin-bottom: var(--space-8);
}

.muwi-academic-editor__focus-footer {
  min-height: 34px;
  border-top: 1px solid var(--color-border-default);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-text-tertiary);
  font-size: var(--font-size-xs);
}

.muwi-statusbar {
  min-height: var(--space-statusbar-height);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  padding-inline: var(--space-3);
  background: var(--color-bg-secondary);
  border-top: 1px solid var(--color-border-default);
  color: var(--color-text-tertiary);
  font-size: var(--font-size-xs);
}

.muwi-statusbar__left,
.muwi-statusbar__right {
  min-width: 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-right-panel {
  width: var(--space-panel-width);
  min-width: var(--space-panel-width);
  flex-shrink: 0;
  background: var(--color-bg-secondary);
  border-left: 1px solid var(--color-border-default);
  display: flex;
  flex-direction: column;
  transform: translateX(0);
  transition: transform var(--duration-slow) var(--ease-out);
}

.muwi-right-panel[data-open='false'] {
  transform: translateX(var(--space-panel-width));
}

.muwi-right-panel__header {
  min-height: var(--space-toolbar-height);
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: var(--space-2);
  border-bottom: 1px solid var(--color-border-default);
  padding-inline: var(--space-2);
}

.muwi-right-panel__title {
  margin: 0;
  font-size: var(--font-size-md);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.muwi-right-panel__body {
  flex: 1;
  overflow: auto;
  min-height: 0;
}

.muwi-diary-layout {
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: var(--color-bg-primary);
}

.muwi-shell {
  flex: 1;
  min-height: 0;
  display: flex;
  overflow: hidden;
  position: relative;
}

.muwi-shell-center {
  flex: 1;
  min-height: 0;
  min-width: 0;
  display: flex;
  flex-direction: column;
}

.muwi-shell-sidebar-backdrop {
  position: absolute;
  inset: 0;
  border: 0;
  padding: 0;
  margin: 0;
  background: var(--color-bg-overlay);
  cursor: pointer;
  z-index: var(--z-overlay);
}

.muwi-shell[data-sidebar-overlay='true'] .muwi-sidebar-shell {
  position: absolute;
  inset: 0 auto 0 0;
  width: var(--space-sidebar-width);
  z-index: calc(var(--z-overlay) + 1);
  pointer-events: none;
}

.muwi-shell[data-sidebar-overlay='true'] .muwi-sidebar-shell[data-open='false'] {
  width: 0;
}

.muwi-shell[data-sidebar-overlay='true'] .muwi-sidebar-shell[data-open='true'] {
  pointer-events: auto;
}

.muwi-shell[data-sidebar-overlay='true'] .muwi-sidebar {
  box-shadow: var(--shadow-lg);
}

.muwi-shell-toolbar {
  min-height: var(--space-toolbar-height);
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding-inline: var(--space-3);
  border-bottom: 1px solid var(--color-border-default);
  background: var(--color-bg-primary);
}

.muwi-shell-toolbar__leading {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-shell-toolbar__content {
  min-width: 0;
  flex: 1;
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-toolbar {
  min-height: var(--space-toolbar-height);
  width: 100%;
  display: flex;
  align-items: center;
  gap: var(--space-1);
  padding-inline: var(--space-3);
  overflow-x: auto;
  overflow-y: hidden;
  scrollbar-width: thin;
  background: var(--color-bg-primary);
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-toolbar__button {
  min-width: var(--size-button-sm);
  height: var(--size-button-sm);
  border: 1px solid transparent;
  border-radius: var(--radius-md);
  background: transparent;
  color: var(--color-text-secondary);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-1);
  padding: var(--space-1);
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  line-height: var(--leading-snug);
  text-decoration: none;
  white-space: nowrap;
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-toolbar__button[data-icon-only='false'] {
  min-width: 0;
  padding-inline: var(--space-2);
}

.muwi-toolbar__button:hover:not(:disabled) {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-toolbar__button[data-active='true']:not(:disabled) {
  background: var(--color-accent-subtle);
  color: var(--color-accent-default);
}

.muwi-toolbar__button:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-toolbar__button:disabled {
  color: var(--color-text-tertiary);
  cursor: default;
}

.muwi-toolbar__icon {
  width: 16px;
  height: 16px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.muwi-toolbar__label {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

.muwi-toolbar__separator {
  width: 1px;
  height: 16px;
  margin-inline: var(--space-1);
  background: var(--color-border-subtle);
  flex-shrink: 0;
}

.muwi-draft-editor__toolbar .muwi-toolbar {
  border-top: 1px solid var(--color-border-default);
  border-bottom: none;
}

.muwi-shell-canvas-region {
  flex: 1;
  min-height: 0;
  min-width: 0;
  overflow: hidden;
  background: var(--color-bg-canvas);
}

.muwi-shell-canvas-inner {
  height: 100%;
  min-height: 0;
  width: 100%;
  overflow: hidden;
  display: flex;
  justify-content: center;
  padding-inline: var(--space-3);
}

.muwi-shell-canvas-slot {
  width: 100%;
  min-width: 0;
  min-height: 0;
  height: 100%;
}

.muwi-shell-canvas-inner[data-constrained='true'] .muwi-shell-canvas-slot {
  max-width: var(--space-canvas-wide-max-width);
}

.muwi-shell-floating-controls {
  position: absolute;
  top: var(--space-3);
  left: var(--space-3);
  z-index: var(--z-toolbar);
}

.muwi-button {
  --muwi-button-height: var(--size-button-md);
  --muwi-button-bg: transparent;
  --muwi-button-fg: var(--color-text-primary);
  --muwi-button-border: var(--color-border-default);
  --muwi-button-hover-bg: var(--color-hover-overlay);
  --muwi-button-active-bg: var(--color-active-overlay);
  --muwi-button-hover-fg: var(--muwi-button-fg);
  --muwi-button-active-fg: var(--muwi-button-fg);
  --muwi-button-hover-border: var(--muwi-button-border);
  --muwi-button-active-border: var(--muwi-button-border);

  height: var(--muwi-button-height);
  min-width: 0;
  border: 1px solid var(--muwi-button-border);
  border-radius: var(--radius-md);
  background: var(--muwi-button-bg);
  color: var(--muwi-button-fg);
  padding-inline: var(--space-3);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-gap-default);
  font-family: var(--font-family-chrome-sans);
  font-size: var(--font-size-base);
  font-weight: var(--weight-medium);
  line-height: var(--leading-snug);
  text-decoration: none;
  text-transform: none;
  user-select: none;
  white-space: nowrap;
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-button:hover:not(:disabled) {
  background: var(--muwi-button-hover-bg);
  color: var(--muwi-button-hover-fg);
  border-color: var(--muwi-button-hover-border);
}

.muwi-button:active:not(:disabled),
.muwi-button[data-active='true']:not(:disabled) {
  background: var(--muwi-button-active-bg);
  color: var(--muwi-button-active-fg);
  border-color: var(--muwi-button-active-border);
}

.muwi-button:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-button:disabled {
  opacity: 0.5;
  pointer-events: none;
  cursor: not-allowed;
}

.muwi-button[data-size='sm'] {
  --muwi-button-height: var(--size-button-sm);
  padding-inline: var(--space-2);
}

.muwi-button[data-size='md'] {
  --muwi-button-height: var(--size-button-md);
  padding-inline: var(--space-3);
}

.muwi-button[data-size='lg'] {
  --muwi-button-height: var(--size-button-lg);
  padding-inline: var(--space-4);
}

.muwi-button[data-variant='primary'] {
  --muwi-button-bg: var(--color-accent-default);
  --muwi-button-fg: var(--color-text-inverse);
  --muwi-button-border: var(--color-accent-default);
  --muwi-button-hover-bg: var(--color-accent-hover);
  --muwi-button-hover-border: var(--color-accent-hover);
  --muwi-button-active-bg: color-mix(in srgb, var(--color-accent-hover) 95%, black);
  --muwi-button-active-border: color-mix(in srgb, var(--color-accent-hover) 95%, black);
}

.muwi-button[data-variant='secondary'] {
  --muwi-button-bg: transparent;
  --muwi-button-fg: var(--color-text-primary);
  --muwi-button-border: var(--color-border-default);
  --muwi-button-hover-bg: var(--color-hover-overlay);
  --muwi-button-active-bg: var(--color-active-overlay);
}

.muwi-button[data-variant='ghost'] {
  --muwi-button-bg: transparent;
  --muwi-button-fg: var(--color-text-secondary);
  --muwi-button-border: transparent;
  --muwi-button-hover-bg: var(--color-hover-overlay);
  --muwi-button-hover-fg: var(--color-text-primary);
  --muwi-button-active-bg: var(--color-active-overlay);
  --muwi-button-active-fg: var(--color-text-primary);
}

.muwi-button[data-variant='danger'] {
  --muwi-button-bg: var(--color-error);
  --muwi-button-fg: var(--color-text-inverse);
  --muwi-button-border: var(--color-error);
  --muwi-button-hover-bg: color-mix(in srgb, var(--color-error) 95%, black);
  --muwi-button-hover-border: color-mix(in srgb, var(--color-error) 95%, black);
  --muwi-button-active-bg: color-mix(in srgb, var(--color-error) 90%, black);
  --muwi-button-active-border: color-mix(in srgb, var(--color-error) 90%, black);
}

.muwi-button[data-icon-only='true'] {
  width: var(--muwi-button-height);
  padding-inline: 0;
  gap: 0;
}

.muwi-button.is-full-width {
  width: 100%;
}

.muwi-button__icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.muwi-button__label {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

.muwi-field {
  display: flex;
  flex-direction: column;
  gap: var(--space-gap-tight);
  min-width: 0;
}

.muwi-field__label {
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-secondary);
}

.muwi-field__hint {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-field__error {
  font-size: var(--font-size-xs);
  color: var(--color-error);
}

.muwi-form-control {
  --muwi-control-bg: var(--color-bg-primary);
  --muwi-control-fg: var(--color-text-primary);
  --muwi-control-border: var(--color-border-subtle);

  height: var(--size-control);
  width: 100%;
  border: 1px solid var(--muwi-control-border);
  border-radius: var(--radius-sm);
  background: var(--muwi-control-bg);
  color: var(--muwi-control-fg);
  padding-inline: var(--space-2);
  font-family: var(--font-family-chrome-sans);
  font-size: var(--font-size-base);
  line-height: var(--leading-snug);
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-form-control::placeholder {
  color: var(--color-text-tertiary);
}

.muwi-form-control:hover:not(:disabled) {
  border-color: var(--color-border-default);
}

.muwi-form-control:focus-visible {
  outline: none;
  border-color: var(--color-accent-default);
  box-shadow: var(--shadow-focus);
}

.muwi-form-control[data-invalid='true'] {
  border-color: var(--color-error);
}

.muwi-form-control:disabled {
  background: var(--color-bg-tertiary);
  color: var(--color-text-tertiary);
  border-color: var(--color-border-default);
  cursor: not-allowed;
}

.muwi-select-wrap {
  position: relative;
}

.muwi-select {
  appearance: none;
  padding-right: var(--space-8);
}

.muwi-select__chevron {
  position: absolute;
  right: var(--space-2);
  top: 50%;
  transform: translateY(-50%);
  color: var(--color-text-tertiary);
  pointer-events: none;
}

.muwi-select:disabled + .muwi-select__chevron {
  color: var(--color-text-tertiary);
}

.muwi-toggle-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-gap-default);
}

.muwi-toggle {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.muwi-toggle__input {
  position: absolute;
  inline-size: 1px;
  block-size: 1px;
  clip-path: inset(50%);
  overflow: hidden;
  white-space: nowrap;
}

.muwi-toggle__track {
  width: var(--size-toggle-width);
  height: var(--size-toggle-height);
  border-radius: var(--radius-full);
  background: var(--color-border-default);
  border: 1px solid transparent;
  position: relative;
  transition: background-color var(--duration-normal) var(--ease-default);
}

.muwi-toggle__thumb {
  position: absolute;
  top: calc((var(--size-toggle-height) - var(--size-toggle-thumb)) / 2);
  left: calc((var(--size-toggle-height) - var(--size-toggle-thumb)) / 2);
  width: var(--size-toggle-thumb);
  height: var(--size-toggle-thumb);
  border-radius: var(--radius-full);
  background: var(--color-bg-primary);
  box-shadow: var(--shadow-sm);
  transition: transform var(--duration-normal) var(--ease-default);
}

.muwi-toggle__input:checked + .muwi-toggle__track {
  background: var(--color-accent-default);
}

.muwi-toggle__input:checked + .muwi-toggle__track .muwi-toggle__thumb {
  transform: translateX(calc(var(--size-toggle-width) - var(--size-toggle-height)));
}

.muwi-toggle__input:focus-visible + .muwi-toggle__track {
  box-shadow: var(--shadow-focus);
}

.muwi-toggle__input:disabled + .muwi-toggle__track {
  opacity: 0.5;
  cursor: not-allowed;
}

.muwi-field.is-invalid .muwi-field__label {
  color: var(--color-error);
}

.muwi-modal-backdrop {
  position: fixed;
  inset: 0;
  z-index: var(--z-overlay);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-6);
  background: var(--color-bg-overlay);
  animation: muwi-modal-backdrop-in var(--duration-normal) var(--ease-out);
}

.muwi-modal {
  width: 100%;
  max-height: 90vh;
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-modal);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  animation: muwi-modal-surface-in var(--duration-normal) var(--ease-out);
}

.muwi-modal__header {
  min-height: 48px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-gap-default);
  padding: var(--space-3) var(--space-4);
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-modal__title {
  margin: 0;
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-modal__body {
  padding: var(--space-5);
  overflow: auto;
}

.muwi-settings-modal {
  width: min(640px, 100%);
  max-width: 640px !important;
  height: min(480px, 90vh);
}

.muwi-settings-modal .muwi-modal__body {
  padding: 0;
  overflow: hidden;
  min-height: 0;
}

.muwi-settings {
  height: 100%;
  min-height: 0;
  display: grid;
  grid-template-columns: 160px minmax(0, 1fr);
}

.muwi-settings__nav {
  padding: var(--space-2);
  background: var(--color-bg-secondary);
  border-right: 1px solid var(--color-border-default);
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  overflow: auto;
}

.muwi-settings__tab {
  width: 100%;
}

.muwi-settings__content {
  min-width: 0;
  min-height: 0;
  padding: var(--space-inset-spacious);
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
  overflow: auto;
}

.muwi-settings__color-input {
  padding: var(--space-1);
  cursor: pointer;
}

.muwi-settings__shortcut-copy p {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-settings__shortcut-copy ul {
  margin: var(--space-2) 0 0;
  padding-left: 1.2rem;
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  line-height: var(--leading-relaxed);
}

.muwi-settings__backup-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-settings__actions {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
}

.muwi-navigation-header {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-3) var(--space-4);
  border-bottom: 1px solid var(--color-border-default);
  background: var(--color-bg-primary);
}

.muwi-navigation-header__back {
  justify-self: start;
}

.muwi-navigation-header__title {
  margin: 0;
  display: inline-flex;
  align-items: center;
  justify-self: center;
  gap: var(--space-2);
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-navigation-header__right {
  min-width: 80px;
  justify-self: end;
}

.muwi-passkey-modal {
  width: min(460px, 100%);
  max-width: 460px !important;
}

.muwi-passkey-form {
  display: grid;
  gap: var(--space-3);
}

.muwi-passkey-description {
  margin: 0;
  font-size: var(--font-size-md);
  color: var(--color-text-secondary);
}

.muwi-passkey-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-passkey-input {
  flex: 1;
}

.muwi-passkey-hint-area {
  display: grid;
  gap: var(--space-2);
}

.muwi-passkey-hint {
  margin: 0;
  padding: var(--space-inset-default);
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-md);
  background: var(--color-bg-secondary);
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-passkey-error {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-error);
}

.muwi-passkey-actions {
  display: flex;
  justify-content: flex-end;
  gap: var(--space-2);
  margin-top: var(--space-1);
}

.muwi-error-boundary {
  min-height: 300px;
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-12);
  background: var(--color-bg-secondary);
  color: var(--color-error);
  text-align: center;
}

.muwi-error-boundary__icon {
  opacity: 0.85;
  margin-bottom: var(--space-3);
}

.muwi-error-boundary__title {
  margin: 0;
  font-size: var(--font-size-xl);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-error-boundary__description {
  margin: 0 0 var(--space-4);
  max-width: 50ch;
  font-size: var(--font-size-md);
  color: var(--color-text-secondary);
}

.muwi-error-boundary__message {
  display: block;
  margin-top: var(--space-2);
  font-family: var(--font-family-mono);
  font-size: var(--font-size-sm);
  color: var(--color-text-tertiary);
}

.muwi-font-selector.is-select {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
}

.muwi-font-selector__label {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-font-selector__select {
  min-width: 9rem;
  height: 26px;
}

.muwi-font-selector.is-menu {
  min-width: 180px;
  display: grid;
  gap: var(--space-0-5);
}

.muwi-font-selector__menu-item {
  width: 100%;
  border: 0;
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--color-text-primary);
  text-align: left;
  padding: var(--space-1-5) var(--space-2);
  font-size: var(--font-size-base);
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-font-selector__menu-item[data-selected='true'] {
  background: var(--color-selected-bg);
  color: var(--color-text-primary);
}

.muwi-font-selector__menu-item:hover:not(:disabled) {
  background: var(--color-hover-overlay);
}

.muwi-font-selector__menu-item:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-export-modal {
  width: min(480px, 100%);
  max-width: 480px !important;
}

.muwi-export-modal .muwi-modal__body {
  padding: 0;
  overflow: hidden;
}

.muwi-export-panel {
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.muwi-export-panel__content {
  padding: var(--space-5);
  overflow: auto;
  display: grid;
  gap: var(--space-4);
}

.muwi-export-panel__section {
  display: grid;
  gap: var(--space-2);
}

.muwi-export-panel__document {
  padding: var(--space-3) var(--space-4);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-secondary);
}

.muwi-export-panel__kicker {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-tertiary);
}

.muwi-export-panel__document-title {
  margin: 0;
  font-size: var(--font-size-md);
  font-weight: var(--weight-medium);
  color: var(--color-text-primary);
}

.muwi-export-panel__progress {
  padding: var(--space-3);
  border: 1px solid color-mix(in srgb, var(--color-info) 35%, var(--color-border-default));
  border-radius: var(--radius-md);
  background: var(--color-info-subtle);
}

.muwi-export-panel__progress-label {
  margin: 0;
  font-size: var(--font-size-sm);
  font-weight: var(--weight-semibold);
  color: var(--color-info);
}

.muwi-export-panel__progress-track {
  width: 100%;
  height: 8px;
  border-radius: var(--radius-full);
  background: color-mix(in srgb, var(--color-info) 25%, transparent);
  overflow: hidden;
}

.muwi-export-panel__progress-fill {
  height: 100%;
  background: var(--color-info);
  transition: width var(--duration-moderate) var(--ease-default);
}

.muwi-export-panel__label {
  margin: 0;
  font-size: var(--font-size-sm);
  font-weight: var(--weight-semibold);
  color: var(--color-text-secondary);
}

.muwi-export-panel__format-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: var(--space-2);
}

.muwi-export-panel__format-option {
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-primary);
  display: grid;
  justify-items: center;
  gap: var(--space-1);
  padding: var(--space-3);
  transition: var(--transition-colors), var(--transition-shadow), var(--transition-transform);
}

.muwi-export-panel__format-option[data-selected='true'] {
  border-color: var(--color-accent-default);
  background: var(--color-accent-subtle);
  box-shadow: var(--shadow-focus);
}

.muwi-export-panel__format-option:hover {
  border-color: var(--color-border-strong);
}

.muwi-export-panel__format-option:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-export-panel__format-icon {
  font-size: var(--font-size-xl);
  line-height: 1;
}

.muwi-export-panel__format-label {
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-secondary);
}

.muwi-export-panel__format-option[data-selected='true'] .muwi-export-panel__format-label {
  color: var(--color-accent-text);
}

.muwi-export-panel__grid-2 {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: var(--space-3);
}

.muwi-export-panel__range {
  width: 100%;
}

.muwi-export-panel__range-scale {
  display: flex;
  justify-content: space-between;
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-export-panel__options {
  display: grid;
  gap: var(--space-2);
}

.muwi-export-panel__checkbox-row {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-md);
  color: var(--color-text-primary);
}

.muwi-export-panel__checkbox-row input {
  width: 16px;
  height: 16px;
}

.muwi-export-panel__hint {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-tertiary);
}

.muwi-export-panel__alert {
  border: 1px solid transparent;
  border-radius: var(--radius-md);
  padding: var(--space-inset-default);
  font-size: var(--font-size-md);
}

.muwi-export-panel__alert[data-variant='error'] {
  background: var(--color-error-subtle);
  border-color: color-mix(in srgb, var(--color-error) 30%, transparent);
  color: var(--color-error);
}

.muwi-export-panel__alert[data-variant='success'] {
  background: var(--color-success-subtle);
  border-color: color-mix(in srgb, var(--color-success) 30%, transparent);
  color: var(--color-success);
}

.muwi-export-panel__footer {
  border-top: 1px solid var(--color-border-default);
  padding: var(--space-4) var(--space-5);
  display: flex;
  justify-content: flex-end;
  gap: var(--space-2);
}

.muwi-export-panel__exporting {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-export-panel__spinner {
  animation: muwi-spin 1s linear infinite;
}

.muwi-backup-modal {
  width: min(520px, 100%);
  max-width: 520px !important;
}

.muwi-backup-modal .muwi-modal__body {
  padding: 0;
  overflow: hidden;
}

.muwi-backup-panel {
  display: flex;
  flex-direction: column;
  min-height: 0;
}

.muwi-backup-panel__content {
  padding: var(--space-5);
  overflow: auto;
  display: grid;
  gap: var(--space-4);
}

.muwi-backup-panel__section {
  display: grid;
  gap: var(--space-2);
}

.muwi-backup-panel__overview {
  padding: var(--space-4);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-secondary);
}

.muwi-backup-panel__overview-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-2);
}

.muwi-backup-panel__overview-title {
  font-size: var(--font-size-md);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-backup-panel__overview-size {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-backup-panel__table-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: var(--space-2);
}

.muwi-backup-panel__table-card {
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-sm);
  background: var(--color-bg-primary);
  padding: var(--space-2) var(--space-3);
}

.muwi-backup-panel__table-name {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-backup-panel__table-count {
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-backup-panel__total {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-backup-panel__label {
  margin: 0;
  font-size: var(--font-size-sm);
  font-weight: var(--weight-semibold);
  color: var(--color-text-secondary);
}

.muwi-backup-panel__button-row {
  display: flex;
  gap: var(--space-3);
}

.muwi-backup-panel__last {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-tertiary);
}

.muwi-backup-panel__checkbox-row {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-md);
  color: var(--color-text-primary);
}

.muwi-backup-panel__active-badge {
  margin-left: var(--space-1);
  padding: var(--space-0-5) var(--space-2);
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  background: var(--color-success-subtle);
  color: var(--color-success);
}

.muwi-backup-panel__auto-settings {
  display: grid;
  gap: var(--space-3);
  margin-left: 1.6rem;
}

.muwi-backup-panel__location-row {
  display: flex;
  gap: var(--space-2);
}

.muwi-backup-panel__location-row .muwi-form-control {
  flex: 1;
}

.muwi-backup-panel__message {
  border: 1px solid transparent;
  border-radius: var(--radius-md);
  padding: var(--space-inset-default);
  font-size: var(--font-size-md);
}

.muwi-backup-panel__message[data-variant='success'] {
  background: var(--color-success-subtle);
  border-color: color-mix(in srgb, var(--color-success) 30%, transparent);
  color: var(--color-success);
}

.muwi-backup-panel__message[data-variant='error'] {
  background: var(--color-error-subtle);
  border-color: color-mix(in srgb, var(--color-error) 30%, transparent);
  color: var(--color-error);
}

.muwi-backup-panel__footer {
  border-top: 1px solid var(--color-border-default);
  padding: var(--space-4) var(--space-5);
  display: flex;
  justify-content: flex-end;
}

.muwi-backup-confirm-modal {
  width: min(400px, 100%);
  max-width: 400px !important;
}

.muwi-backup-confirm__text {
  margin: 0;
  color: var(--color-text-secondary);
  font-size: var(--font-size-md);
  line-height: var(--leading-normal);
}

.muwi-backup-confirm__actions {
  margin-top: var(--space-4);
  display: flex;
  justify-content: flex-end;
  gap: var(--space-2);
}

.muwi-blackboard-toolbar {
  width: 100%;
  min-width: 0;
  display: flex;
  align-items: center;
  gap: var(--space-1);
  overflow-x: auto;
  overflow-y: hidden;
  scrollbar-width: thin;
}

.muwi-blackboard-toolbar__group {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  flex-shrink: 0;
}

.muwi-blackboard-toolbar__field {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
}

.muwi-blackboard-toolbar__field-label {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-blackboard-toolbar__color {
  width: 28px;
  height: 26px;
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-sm);
  background: transparent;
  padding: 0;
}

.muwi-blackboard-toolbar__width {
  width: 6.75rem;
  height: 26px;
  font-size: var(--font-size-sm);
}

.muwi-blackboard-toolbar__font .muwi-font-selector__label {
  font-size: var(--font-size-xs);
}

.muwi-blackboard-toolbar__font .muwi-font-selector__select {
  min-width: 7.5rem;
}

.muwi-blackboard-toolbar__zoom-readout {
  min-width: 4rem;
  justify-content: center;
}

.muwi-blackboard-index {
  min-height: 0;
  display: flex;
  flex-direction: column;
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-md);
  background: var(--color-bg-primary);
}

.muwi-blackboard-index.is-collapsed {
  min-height: 2.5rem;
  align-items: center;
  justify-content: center;
  border-style: dashed;
}

.muwi-blackboard-index__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
  padding: var(--space-1) var(--space-2);
  border-bottom: 1px solid var(--color-border-subtle);
}

.muwi-blackboard-index__label {
  margin: 0;
  font-size: var(--font-size-xs);
  font-weight: var(--weight-semibold);
  color: var(--color-text-tertiary);
  letter-spacing: var(--tracking-wider);
}

.muwi-blackboard-index__body {
  min-height: 0;
  overflow-y: auto;
}

.muwi-blackboard-index__empty {
  margin: 0;
  padding: var(--space-3) var(--space-2);
  font-size: var(--font-size-sm);
  color: var(--color-text-tertiary);
  line-height: var(--leading-normal);
}

.muwi-blackboard-index__list {
  margin: 0;
  padding: var(--space-1) 0;
  list-style: none;
}

.muwi-blackboard-index__item {
  width: 100%;
  border: 0;
  border-radius: 0;
  background: transparent;
  color: var(--color-text-secondary);
  min-height: 32px;
  text-align: left;
  padding-block: var(--space-1);
  padding-inline-end: var(--space-2);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  transition: var(--transition-colors);
}

.muwi-blackboard-index__item:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-blackboard-index__item:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-blackboard-index__footer {
  border-top: 1px solid var(--color-border-subtle);
  padding: var(--space-1) var(--space-2);
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-blackboard-canvas {
  width: 100%;
  height: 100%;
  position: relative;
  overflow: hidden;
}

.muwi-blackboard-state {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 3;
  width: min(360px, calc(100% - var(--space-6)));
  display: grid;
  justify-items: center;
  gap: var(--space-2);
  text-align: center;
  padding: var(--space-4);
  border: 1px solid color-mix(in srgb, var(--color-bb-text) 20%, transparent);
  border-radius: var(--radius-lg);
  background: color-mix(in srgb, var(--color-bb-canvas) 78%, black);
  box-shadow: var(--shadow-md);
}

.muwi-blackboard-state__icon {
  color: var(--color-bb-accent);
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.muwi-blackboard-state__title {
  margin: 0;
  font-size: var(--font-size-lg);
  font-weight: var(--weight-medium);
  color: var(--color-bb-text);
}

.muwi-blackboard-state__text {
  margin: 0;
  font-size: var(--font-size-sm);
  color: color-mix(in srgb, var(--color-bb-text) 72%, transparent);
  line-height: var(--leading-normal);
}

.muwi-blackboard-state__action {
  margin-top: var(--space-1);
}

.muwi-blackboard-canvas__message {
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-text-tertiary);
  padding: var(--space-6);
  text-align: center;
}

.muwi-blackboard-canvas__message.is-error {
  flex-direction: column;
  gap: var(--space-4);
  color: var(--color-error);
}

.muwi-blackboard-canvas__message.is-error p {
  margin: 0;
}

.muwi-blackboard-panel {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.muwi-blackboard-panel__label {
  margin: 0;
  font-size: var(--font-size-xs);
  font-weight: var(--weight-semibold);
  letter-spacing: var(--tracking-wider);
  text-transform: uppercase;
  color: var(--color-text-tertiary);
}

.muwi-blackboard-panel__title {
  margin: var(--space-1-5) 0 0;
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-blackboard-panel__meta {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-blackboard-panel__hint {
  margin: 0;
  font-size: var(--font-size-sm);
  line-height: var(--leading-normal);
  color: var(--color-text-tertiary);
}

.muwi-blackboard-panel__list {
  display: flex;
  flex-direction: column;
  gap: var(--space-1-5);
}

.muwi-blackboard-panel__item {
  width: 100%;
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-primary);
  padding: var(--space-2) var(--space-3);
  text-align: left;
  font-size: var(--font-size-sm);
  color: var(--color-text-primary);
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-blackboard-panel__item:hover {
  background: var(--color-hover-overlay);
}

.muwi-blackboard-panel__item:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-blackboard-font-menu {
  position: fixed;
  z-index: var(--z-tooltip);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-lg);
  background: var(--color-bg-elevated);
  box-shadow: var(--shadow-lg);
  padding: var(--space-1-5);
}

.muwi-scratchpad-toolbar {
  width: 100%;
  min-width: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
}

.muwi-scratchpad-toolbar__controls {
  min-width: 0;
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
}

.muwi-scratchpad-toolbar__page-indicator {
  min-width: 6.75rem;
  text-align: center;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-scratchpad-sidebar__label {
  margin: 0;
  font-size: var(--font-size-xs);
  font-weight: var(--weight-semibold);
  color: var(--color-text-tertiary);
  letter-spacing: var(--tracking-wider);
}

.muwi-scratchpad-sidebar__new-page {
  width: 100%;
}

.muwi-scratchpad-canvas {
  height: 100%;
  min-height: 0;
  overflow: auto;
  padding: var(--space-6);
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(
    180deg,
    color-mix(in srgb, var(--color-bg-canvas) 85%, var(--color-bg-secondary)),
    var(--color-bg-canvas)
  );
}

.muwi-scratchpad-state {
  width: min(420px, 100%);
  display: grid;
  justify-items: center;
  text-align: center;
  gap: var(--space-2);
  padding: var(--space-6);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-lg);
  background: var(--color-bg-elevated);
  box-shadow: var(--shadow-sm);
}

.muwi-scratchpad-state__title {
  margin: 0;
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-scratchpad-state__text {
  margin: 0;
  font-size: var(--font-size-md);
  color: var(--color-text-secondary);
}

.muwi-scratchpad-stack {
  display: grid;
  gap: var(--space-1);
}

.muwi-scratchpad-stack__item {
  width: 100%;
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-md);
  background: var(--color-bg-primary);
  padding: var(--space-2);
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: var(--space-2);
  text-align: left;
  transition: var(--transition-colors), var(--transition-shadow), var(--transition-transform);
}

.muwi-scratchpad-stack__item:hover {
  border-color: var(--color-border-strong);
  box-shadow: var(--shadow-xs);
}

.muwi-scratchpad-stack__item[data-active='true'] {
  border-color: var(--color-accent-default);
  background: var(--color-selected-bg);
}

.muwi-scratchpad-stack__item[data-has-content='false'] {
  opacity: 0.72;
}

.muwi-scratchpad-stack__item:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-scratchpad-stack__dot {
  width: 8px;
  height: 8px;
  border-radius: var(--radius-full);
  background: var(--muwi-page-dot, var(--color-cat-notes));
  box-shadow: 0 0 0 1px color-mix(in srgb, var(--color-text-primary) 14%, transparent);
}

.muwi-scratchpad-stack__label {
  font-size: var(--font-size-sm);
  color: var(--color-text-primary);
}

.muwi-scratchpad-stack__meta {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-scratchpad-stack__lock {
  grid-column: 1 / -1;
  justify-self: end;
  font-size: var(--font-size-xs);
  color: var(--color-locked);
}

.muwi-scratchpad-category-picker {
  position: relative;
  display: inline-flex;
}

.muwi-scratchpad-category-picker__trigger {
  height: var(--size-button-sm);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-primary);
  color: var(--color-text-primary);
  padding-inline: var(--space-2);
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-scratchpad-category-picker__trigger:hover:not(:disabled) {
  background: var(--color-hover-overlay);
  border-color: var(--color-border-strong);
}

.muwi-scratchpad-category-picker__trigger:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-scratchpad-category-picker__trigger:disabled {
  opacity: 0.55;
}

.muwi-scratchpad-category-picker__swatch {
  width: 12px;
  height: 12px;
  border-radius: var(--radius-sm);
  border: 1px solid color-mix(in srgb, var(--color-text-primary) 12%, transparent);
  background: var(--muwi-category-swatch, var(--color-cat-notes));
}

.muwi-scratchpad-category-picker__chevron {
  color: var(--color-text-tertiary);
  transition: var(--transition-transform);
}

.muwi-scratchpad-category-picker__chevron[data-open='true'] {
  transform: rotate(180deg);
}

.muwi-scratchpad-category-picker__menu {
  position: absolute;
  top: calc(100% + var(--space-1));
  left: 0;
  z-index: var(--z-dropdown);
  min-width: 170px;
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-elevated);
  box-shadow: var(--shadow-dropdown);
  padding: var(--space-1);
  display: grid;
  gap: var(--space-0-5);
}

.muwi-scratchpad-category-picker__option {
  border: 0;
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--color-text-primary);
  padding: var(--space-1-5) var(--space-2);
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-sm);
  text-align: left;
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-scratchpad-category-picker__option:hover {
  background: var(--color-hover-overlay);
}

.muwi-scratchpad-category-picker__option[data-selected='true'] {
  background: var(--color-selected-bg);
  font-weight: var(--weight-medium);
}

.muwi-scratchpad-category-picker__option:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-scratchpad-category-picker__check {
  margin-left: auto;
  color: var(--color-accent-default);
}

.muwi-scratchpad-page {
  width: 100%;
  min-height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.muwi-scratchpad-page__stack {
  width: 408px;
  height: 608px;
  position: relative;
}

.muwi-scratchpad-page__shadow {
  position: absolute;
  width: 400px;
  height: 600px;
  border-radius: var(--radius-md);
  border: 1px solid color-mix(in srgb, var(--color-border-default) 90%, transparent);
}

.muwi-scratchpad-page__shadow.is-depth-1 {
  inset: 4px 0 0 4px;
  background: color-mix(in srgb, var(--color-bg-tertiary) 86%, var(--color-bg-primary));
}

.muwi-scratchpad-page__shadow.is-depth-2 {
  inset: 2px 0 0 2px;
  background: color-mix(in srgb, var(--color-bg-secondary) 88%, var(--color-bg-primary));
}

.muwi-scratchpad-page__canvas {
  position: relative;
  width: 400px;
  height: 600px;
  border-radius: var(--radius-md);
  border: 1px solid var(--color-border-on-canvas);
  box-shadow: var(--shadow-md);
  overflow: hidden;
  cursor: text;
  background: color-mix(
    in srgb,
    var(--muwi-scratchpad-page-color, var(--color-cat-notes)) 86%,
    var(--color-bg-primary)
  );
}

.muwi-scratchpad-page__canvas[data-category='ideas'] {
  --muwi-scratchpad-page-color: var(--color-cat-ideas);
}

.muwi-scratchpad-page__canvas[data-category='todos'] {
  --muwi-scratchpad-page-color: var(--color-cat-todos);
}

.muwi-scratchpad-page__canvas[data-category='notes'] {
  --muwi-scratchpad-page-color: var(--color-cat-notes);
}

.muwi-scratchpad-page__canvas[data-category='questions'] {
  --muwi-scratchpad-page-color: var(--color-cat-questions);
}

.muwi-scratchpad-page__canvas[data-category='misc'] {
  --muwi-scratchpad-page-color: var(--color-cat-misc);
}

.muwi-scratchpad-page__canvas[data-locked='true'] {
  cursor: not-allowed;
}

.muwi-scratchpad-page__texture {
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0.28;
  background-image: radial-gradient(
    circle at 20% 20%,
    color-mix(in srgb, var(--color-text-primary) 8%, transparent) 0 1px,
    transparent 1px
  );
  background-size: 24px 24px;
}

.muwi-scratchpad-page__empty {
  position: absolute;
  inset: 0;
  padding: var(--space-6);
  display: grid;
  justify-items: center;
  align-content: center;
  gap: var(--space-2);
  text-align: center;
}

.muwi-scratchpad-page__empty-icon {
  color: var(--color-text-tertiary);
}

.muwi-scratchpad-page__empty-title {
  margin: 0;
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-scratchpad-page__empty-text {
  margin: 0;
  max-width: 32ch;
  font-size: var(--font-size-md);
  line-height: var(--leading-normal);
  color: var(--color-text-secondary);
}

.muwi-scratchpad-page__empty-action {
  margin-top: var(--space-1);
}

.muwi-scratchpad-page__locked-overlay {
  position: absolute;
  inset: 0;
  background: color-mix(in srgb, var(--color-locked-bg) 85%, transparent);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-locked);
}

.muwi-scratchpad-text-block {
  position: absolute;
  min-width: 40px;
  max-width: calc(100% - 40px);
  transition: var(--transition-shadow), var(--transition-opacity), var(--transition-transform);
}

.muwi-scratchpad-text-block[data-focused='true'] {
  border-radius: var(--radius-sm);
  box-shadow: var(--shadow-focus);
}

.muwi-scratchpad-text-block[data-dragging='true'] {
  opacity: 0.78;
  cursor: grabbing;
}

.muwi-scratchpad-text-block[data-locked='true'] {
  cursor: not-allowed;
}

.muwi-scratchpad-text-block__drag-outline {
  position: absolute;
  inset: -4px;
  border: 1px dashed color-mix(in srgb, var(--color-border-strong) 90%, transparent);
  border-radius: var(--radius-sm);
  opacity: 0;
  pointer-events: none;
  transition: var(--transition-opacity);
}

.muwi-scratchpad-text-block:hover .muwi-scratchpad-text-block__drag-outline {
  opacity: 1;
}

.muwi-scratchpad-text-block[data-focused='true'] .muwi-scratchpad-text-block__drag-outline,
.muwi-scratchpad-text-block[data-locked='true'] .muwi-scratchpad-text-block__drag-outline {
  opacity: 0;
}

.muwi-scratchpad-text-block__lock-indicator {
  position: absolute;
  right: calc(-1 * var(--space-6));
  top: var(--space-0-5);
  color: var(--color-locked);
}

.muwi-scratchpad-text-block__lock-toggle {
  position: absolute;
  top: calc(-1 * var(--space-6));
  right: 0;
  border: 0;
  border-radius: var(--radius-sm);
  background: var(--color-bg-elevated);
  color: var(--color-text-tertiary);
  padding: var(--space-0-5) var(--space-2);
  font-size: var(--font-size-xs);
  line-height: 1.2;
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-scratchpad-text-block__lock-toggle:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-scratchpad-text-block__lock-toggle:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-scratchpad-text-block__content {
  min-height: 1.5em;
  border-radius: var(--radius-sm);
  padding: var(--space-1) var(--space-2);
  outline: none;
  white-space: pre-wrap;
  word-break: break-word;
  color: var(--color-text-on-canvas);
}

.muwi-scratchpad-text-block[data-locked='true'] .muwi-scratchpad-text-block__content {
  opacity: 0.8;
  cursor: not-allowed;
}

.muwi-shelf {
  min-height: 100vh;
  padding: var(--space-12) var(--space-8) var(--space-6);
  background: var(--color-bg-primary);
  display: flex;
  flex-direction: column;
  gap: var(--space-5);
}

.muwi-shelf__header {
  width: min(960px, 100%);
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
}

.muwi-shelf__title {
  margin: 0;
  font-size: var(--font-size-xl);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
  letter-spacing: var(--tracking-tight);
}

.muwi-shelf__grid {
  width: min(960px, 100%);
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: var(--space-gap-relaxed);
  transition: opacity var(--duration-normal) var(--ease-in),
    transform var(--duration-normal) var(--ease-in);
}

@media (max-width: 480px) {
  .muwi-shelf {
    padding-inline: var(--space-4);
    padding-top: var(--space-8);
  }

  .muwi-shelf__grid {
    gap: var(--space-3);
  }

  .muwi-diary-card {
    padding: var(--space-4);
  }
}

@media (min-width: 768px) {
  .muwi-shelf__grid {
    grid-template-columns: repeat(3, minmax(200px, 1fr));
  }
}

@media (min-width: 960px) {
  .muwi-shelf__grid {
    grid-template-columns: repeat(4, minmax(200px, 1fr));
  }
}

.muwi-shelf__grid.is-list {
  grid-template-columns: 1fr;
  width: min(760px, 100%);
}

.muwi-shelf__grid.is-shelf {
  width: min(960px, 100%);
  padding: var(--space-3);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-lg);
  background: linear-gradient(
    180deg,
    color-mix(in srgb, var(--color-accent-default) 10%, transparent),
    color-mix(in srgb, var(--color-accent-default) 18%, transparent)
  );
}

.muwi-shelf__hint {
  width: min(960px, 100%);
  margin: auto auto 0;
  text-align: center;
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
}

.muwi-shelf[data-transitioning='true'] .muwi-shelf__grid {
  opacity: 0;
  transform: translateY(4px);
}

.muwi-diary-card {
  min-height: 140px;
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-lg);
  background: var(--color-bg-primary);
  box-shadow: var(--shadow-card-rest);
  padding: var(--space-4) var(--space-6);
  text-align: left;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: var(--space-2);
  transition: var(--transition-colors), var(--transition-shadow), var(--transition-transform);
}

.muwi-diary-card__icon {
  width: 24px;
  height: 24px;
  color: var(--color-text-tertiary);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  align-self: center;
}

.muwi-diary-card__body {
  display: grid;
  gap: var(--space-1);
}

.muwi-diary-card__title {
  margin: 0;
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-diary-card__description {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  line-height: var(--leading-snug);
}

.muwi-diary-card__meta {
  margin: 0;
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
}

.muwi-diary-card:hover {
  border-color: var(--color-border-strong);
  box-shadow: var(--shadow-card-hover);
  transform: translateY(-1px);
}

.muwi-diary-card:hover .muwi-diary-card__icon {
  color: var(--color-text-secondary);
}

.muwi-diary-card:active {
  transform: translateY(0);
  box-shadow: var(--shadow-xs);
}

.muwi-diary-card:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-diary-card[data-selected='true'] {
  border-color: var(--color-accent-default);
  box-shadow: inset 0 0 0 0.5px var(--color-accent-default), var(--shadow-card-hover);
}

.muwi-shelf[data-transitioning='true'] .muwi-diary-card[data-selected='true'] {
  transform: translateY(-1px);
}

.muwi-diary-card[data-layout='list'] {
  min-height: 0;
  display: grid;
  grid-template-columns: 24px 1fr auto;
  align-items: center;
  gap: var(--space-3);
  padding: var(--space-4);
}

.muwi-diary-card[data-layout='list'] .muwi-diary-card__icon {
  align-self: center;
}

.muwi-diary-card[data-layout='list'] .muwi-diary-card__meta {
  justify-self: end;
  white-space: nowrap;
}

.muwi-diary-card[data-layout='shelf'] {
  box-shadow: inset 0 -8px 18px color-mix(in srgb, var(--color-text-primary) 10%, transparent),
    var(--shadow-card-rest);
  transform-origin: bottom center;
}

.muwi-command-palette-backdrop {
  position: fixed;
  inset: 0;
  z-index: var(--z-command-palette);
  background: var(--color-bg-overlay);
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: 20vh;
  padding-inline: var(--space-4);
}

.muwi-command-palette {
  width: min(520px, 100%);
  min-width: min(400px, 100%);
  max-height: 400px;
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-xl);
  background: var(--color-bg-elevated);
  box-shadow: var(--shadow-xl);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.muwi-command-palette__input-row {
  min-height: 48px;
  display: flex;
  align-items: center;
  gap: var(--space-2);
  padding-inline: var(--space-3);
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-command-palette__search-icon {
  color: var(--color-text-tertiary);
  flex-shrink: 0;
}

.muwi-command-palette__input {
  flex: 1;
  border: none;
  outline: none;
  background: transparent;
  color: var(--color-text-primary);
  font-size: var(--font-size-lg);
  font-family: var(--font-family-chrome-sans);
}

.muwi-command-palette__input::placeholder {
  color: var(--color-text-tertiary);
}

.muwi-command-palette__results {
  overflow: auto;
  padding: var(--space-2);
  display: grid;
  gap: var(--space-1);
}

.muwi-command-palette__group {
  margin: var(--space-1) 0 0;
  padding-top: var(--space-2);
  border-top: 1px solid var(--color-border-subtle);
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-command-palette__option {
  width: 100%;
  min-height: 36px;
  border: none;
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--color-text-primary);
  padding: var(--space-2) var(--space-3);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  text-align: left;
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-command-palette__option-label {
  font-size: var(--font-size-base);
}

.muwi-command-palette__option-shortcut {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-command-palette__option[data-active='true'],
.muwi-command-palette__option:hover {
  background: var(--color-selected-bg);
}

.muwi-command-palette__option:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-command-palette__empty {
  margin: 0;
  padding: var(--space-4);
  text-align: center;
  color: var(--color-text-tertiary);
  font-size: var(--font-size-sm);
}

.muwi-personal-nav__label {
  margin: 0;
  font-size: var(--font-size-xs);
  font-weight: var(--weight-semibold);
  letter-spacing: var(--tracking-wider);
  color: var(--color-text-tertiary);
}

.muwi-personal-nav {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  min-height: 0;
}

.muwi-personal-nav__empty {
  margin: 0;
  padding: var(--space-4) var(--space-2);
  text-align: center;
  color: var(--color-text-tertiary);
  font-size: var(--font-size-sm);
}

.muwi-personal-nav__group {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.muwi-personal-nav__group-header {
  margin: 0;
  padding: 0 var(--space-2);
  font-size: var(--font-size-xs);
  font-weight: var(--weight-semibold);
  letter-spacing: var(--tracking-wide);
  color: var(--color-text-tertiary);
}

.muwi-personal-nav__group-items {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.muwi-personal-nav__entry {
  width: 100%;
  border: none;
  border-radius: var(--radius-sm);
  background: transparent;
  padding: var(--space-2);
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  text-align: left;
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-personal-nav__entry:hover {
  background: var(--color-hover-overlay);
}

.muwi-personal-nav__entry:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-personal-nav__entry[data-active='true'] {
  background: var(--color-selected-bg);
}

.muwi-personal-nav__entry-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
}

.muwi-personal-nav__entry-date-wrap {
  min-width: 0;
  display: inline-flex;
  align-items: center;
  gap: var(--space-1-5);
}

.muwi-personal-nav__entry-date {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-primary);
}

.muwi-personal-nav__entry-preview {
  display: block;
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.muwi-personal-nav__today-pill {
  padding: var(--space-0-5) var(--space-1-5);
  border-radius: var(--radius-full);
  background: var(--color-accent-subtle);
  color: var(--color-accent-default);
  font-size: var(--font-size-xs);
  font-weight: var(--weight-medium);
}

.muwi-personal-nav__mood-dot {
  width: 8px;
  height: 8px;
  border-radius: var(--radius-full);
  flex-shrink: 0;
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--color-bg-secondary) 55%, transparent);
}

.muwi-personal-nav__today-action {
  justify-content: center;
}

.muwi-personal-toolbar {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
}

.muwi-personal-toolbar__date {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-personal-canvas {
  --muwi-personal-canvas-color: var(--color-bg-canvas-warm);

  height: 100%;
  display: flex;
  overflow: hidden;
  background-color: var(--muwi-personal-canvas-color);
}

.muwi-personal-canvas__state {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  color: var(--color-text-tertiary);
  padding: var(--space-6);
  text-align: center;
}

.muwi-personal-canvas__title {
  margin: 0;
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-personal-canvas__text {
  margin: 0;
  font-size: var(--font-size-md);
  color: var(--color-text-secondary);
}

.muwi-personal-canvas__action {
  margin-top: var(--space-1);
}

.muwi-personal-canvas__state.is-error {
  gap: var(--space-4);
  color: var(--color-error);
}

.muwi-personal-canvas__state.is-error p {
  margin: 0;
}

.muwi-personal-canvas__state.is-empty {
  color: var(--color-text-secondary);
}

.muwi-personal-entry {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.muwi-personal-entry__empty {
  flex: 1;
  min-height: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-text-tertiary);
}

.muwi-personal-entry__header {
  padding: var(--space-4) var(--space-6);
  border-bottom: 1px solid var(--color-border-default);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-4);
  background-color: var(--color-bg-primary);
}

.muwi-personal-date-picker {
  position: relative;
  display: inline-block;
}

.muwi-personal-date-picker__trigger {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-lg);
  background: var(--color-bg-primary);
  color: var(--color-text-primary);
  font-size: var(--font-size-lg);
  font-weight: var(--weight-medium);
  line-height: var(--leading-normal);
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-personal-date-picker__trigger:hover {
  background: var(--color-hover-overlay);
}

.muwi-personal-date-picker__trigger:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-personal-date-picker__trigger-icon {
  color: var(--color-text-secondary);
}

.muwi-personal-date-picker__dialog {
  position: absolute;
  top: calc(100% + var(--space-1));
  left: 0;
  min-width: 17.5rem;
  padding: var(--space-3);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-xl);
  background: var(--color-bg-elevated);
  box-shadow: var(--shadow-md);
  z-index: var(--z-dropdown);
}

.muwi-personal-date-picker__month-nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-3);
}

.muwi-personal-date-picker__month-button {
  min-width: var(--size-button-sm);
  height: var(--size-button-sm);
  border: none;
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--color-text-secondary);
  font-size: var(--content-font-size-h3);
  line-height: 1;
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-personal-date-picker__month-button:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-personal-date-picker__month-button:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-personal-date-picker__month-label {
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-personal-date-picker__calendar {
  display: grid;
  gap: var(--space-0-5);
}

.muwi-personal-date-picker__weekdays,
.muwi-personal-date-picker__week {
  display: grid;
  grid-template-columns: repeat(7, minmax(0, 1fr));
  gap: var(--space-0-5);
}

.muwi-personal-date-picker__weekday {
  padding: var(--space-1);
  text-align: center;
  font-size: var(--font-size-xs);
  font-weight: var(--weight-medium);
  color: var(--color-text-tertiary);
}

.muwi-personal-date-picker__day {
  min-height: var(--size-button-md);
  border: none;
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--color-text-primary);
  font-size: var(--font-size-md);
  font-weight: var(--weight-regular);
  line-height: var(--leading-normal);
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-personal-date-picker__day:hover {
  background: var(--color-hover-overlay);
}

.muwi-personal-date-picker__day:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-personal-date-picker__day[data-outside-month='true'] {
  color: var(--color-text-tertiary);
}

.muwi-personal-date-picker__day[data-today='true'] {
  background: var(--color-accent-subtle);
  color: var(--color-accent-text);
  font-weight: var(--weight-semibold);
}

.muwi-personal-date-picker__day[data-selected='true'] {
  background: var(--color-accent-default);
  color: var(--color-text-inverse);
}

.muwi-personal-date-picker__day[data-selected='true']:hover {
  background: var(--color-accent-hover);
}

.muwi-personal-date-picker__today {
  width: 100%;
  margin-top: var(--space-3);
  min-height: var(--size-button-md);
  border: 1px solid var(--color-accent-default);
  border-radius: var(--radius-md);
  background: transparent;
  color: var(--color-accent-default);
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  line-height: var(--leading-normal);
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-personal-date-picker__today:hover {
  background: var(--color-accent-subtle);
}

.muwi-personal-date-picker__today:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-personal-entry__meta {
  display: flex;
  align-items: center;
  gap: var(--space-4);
  min-width: 0;
}

.muwi-personal-entry__meta-text {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  white-space: nowrap;
}

.muwi-personal-entry__meta-text.is-subtle {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-personal-entry__lock-state {
  font-size: var(--font-size-xs);
  font-weight: var(--weight-semibold);
  color: var(--color-text-secondary);
}

.muwi-personal-entry__lock-toggle {
  white-space: nowrap;
}

.muwi-personal-entry__paper {
  flex: 1;
  min-height: 0;
  overflow: auto;
}

.muwi-personal-entry__content {
  max-width: 800px;
  margin: 0 auto;
  padding: var(--space-6) var(--space-10);
}

.muwi-personal-entry-editor {
  outline: none;
  min-height: 300px;
  font-size: var(--content-font-size-body);
  line-height: var(--leading-relaxed);
  color: var(--color-text-on-canvas);
}

.muwi-personal-entry__editor-content {
  min-height: 100%;
}

.muwi-personal-entry__toolbar {
  padding: var(--space-2) var(--space-4);
  border-top: 1px solid var(--color-border-default);
  background-color: var(--color-bg-primary);
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.muwi-personal-entry__toolbar-button {
  min-width: var(--size-button-sm);
  height: var(--size-button-sm);
  padding: var(--space-1) var(--space-2);
  border: none;
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  line-height: var(--leading-snug);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-1);
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-personal-entry__toolbar-button:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-personal-entry__toolbar-button:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-personal-entry__toolbar-button[data-active='true'] {
  background: var(--color-accent-subtle);
  color: var(--color-accent-default);
}

.muwi-personal-entry__toolbar-separator {
  width: 1px;
  height: 16px;
  background: var(--color-border-subtle);
  margin: 0 var(--space-1);
}

.muwi-personal-entry__font-display {
  font-size: var(--font-size-sm);
  color: var(--color-text-tertiary);
  font-weight: var(--weight-medium);
  white-space: nowrap;
}

@keyframes muwi-modal-backdrop-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes muwi-modal-surface-in {
  from {
    opacity: 0;
    transform: scale(0.97);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes muwi-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.muwi-context-menu {
  min-width: 200px;
  max-width: 280px;
  width: 220px;
  padding-block: var(--space-1);
  background: var(--color-bg-elevated);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
}

.muwi-context-menu:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-context-menu--submenu {
  width: 220px;
}

.muwi-context-menu__item {
  width: 100%;
  min-height: 32px;
  border: none;
  background: transparent;
  color: var(--color-text-primary);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-gap-default);
  padding: var(--space-1) var(--space-3);
  font-size: var(--font-size-sm);
  text-align: left;
  border-radius: var(--radius-sm);
  cursor: pointer;
}

.muwi-context-menu__item-main {
  min-width: 0;
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-context-menu__icon {
  width: 16px;
  height: 16px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.muwi-context-menu__item-meta {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  color: var(--color-text-tertiary);
}

.muwi-context-menu__shortcut {
  font-size: var(--font-size-xs);
}

.muwi-context-menu__item:hover:not(:disabled),
.muwi-context-menu__item[data-active='true']:not(:disabled) {
  background: var(--color-accent-subtle);
  color: var(--color-text-primary);
}

.muwi-context-menu__item:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-context-menu__item:disabled {
  color: var(--color-text-tertiary);
  cursor: default;
}

.muwi-context-menu__item[data-destructive='true'] {
  color: var(--color-error);
}

.muwi-context-menu__separator {
  height: 1px;
  margin: var(--space-1) 0;
  background: var(--color-border-default);
}

.muwi-toast-viewport {
  position: fixed;
  left: 50%;
  bottom: var(--space-6);
  transform: translateX(-50%);
  z-index: var(--z-toast);
  width: min(560px, calc(100vw - var(--space-6) * 2));
  display: grid;
  gap: var(--space-2);
  pointer-events: none;
}

.muwi-toast {
  pointer-events: auto;
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: start;
  gap: var(--space-2);
  padding: var(--space-inset-default);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-md);
  background: var(--color-bg-elevated);
  box-shadow: var(--shadow-lg);
  animation: muwi-toast-in var(--duration-moderate) var(--ease-out);
}

.muwi-toast__icon {
  width: 16px;
  height: 16px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-top: 2px;
  color: var(--color-info);
}

.muwi-toast[data-variant='success'] .muwi-toast__icon {
  color: var(--color-success);
}

.muwi-toast[data-variant='warning'] .muwi-toast__icon {
  color: var(--color-warning);
}

.muwi-toast[data-variant='error'] .muwi-toast__icon {
  color: var(--color-error);
}

.muwi-toast__content {
  min-width: 0;
  display: grid;
  gap: var(--space-0-5);
}

.muwi-toast__title {
  margin: 0;
  font-size: var(--font-size-sm);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-toast__message {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-toast__close {
  width: 24px;
  height: 24px;
  border: 1px solid transparent;
  border-radius: var(--radius-sm);
  background: transparent;
  color: var(--color-text-tertiary);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  transition: var(--transition-colors), var(--transition-shadow);
}

.muwi-toast__close:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-toast__close:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

@keyframes muwi-toast-in {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ==========================================================================
   Dropdowns
   ========================================================================== */

.muwi-dropdown {
  position: relative;
  flex: 1;
}

.muwi-dropdown__trigger {
  width: 100%;
  padding: var(--space-1) var(--space-2);
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
  background-color: var(--color-bg-primary);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-sm);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
  transition: var(--transition-colors);
}

.muwi-dropdown__trigger:hover {
  border-color: var(--color-border-hover);
}

.muwi-dropdown__trigger:focus-visible {
  outline: none;
  box-shadow: var(--shadow-focus);
}

.muwi-dropdown__chevron {
  transition: transform var(--duration-normal) var(--ease-default);
}

.muwi-dropdown__trigger[aria-expanded='true'] .muwi-dropdown__chevron {
  transform: rotate(180deg);
}

.muwi-dropdown__menu {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: var(--space-1);
  background-color: var(--color-bg-primary);
  border: 1px solid var(--color-border-default);
  border-radius: var(--radius-sm);
  box-shadow: var(--shadow-md);
  z-index: var(--z-dropdown);
  overflow: hidden;
}

.muwi-dropdown__item {
  width: 100%;
  padding: var(--space-2) var(--space-3);
  font-size: var(--font-size-xs);
  text-align: left;
  border: none;
  background: transparent;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  color: var(--color-text-primary);
  transition: var(--transition-colors);
}

.muwi-dropdown__item:hover {
  background-color: var(--color-bg-tertiary);
}

.muwi-dropdown__item.is-active {
  background-color: var(--color-bg-tertiary);
}

.muwi-dropdown__item-indicator {
  color: var(--color-text-secondary);
}

/* ==========================================================================
   Empty States
   ========================================================================== */

.muwi-empty-state {
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--space-3);
  color: var(--color-text-secondary);
  text-align: center;
  padding: var(--space-6);
}

.muwi-empty-state__icon {
  color: var(--color-text-tertiary);
  opacity: 0.5;
}

.muwi-empty-state__title {
  margin: 0;
  font-size: var(--font-size-lg);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-empty-state__description {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-empty-state__action {
  margin-top: var(--space-2);
}

/* ==========================================================================
   Loading States
   ========================================================================== */

.muwi-loading-state {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-text-secondary);
}

.muwi-loading-state__content {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.muwi-loading-state__spinner {
  animation: muwi-spin 1s linear infinite;
}

@keyframes muwi-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* ==========================================================================
   Error States
   ========================================================================== */

.muwi-error-state {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--color-error);
  flex-direction: column;
  gap: var(--space-4);
}

.muwi-error-state__icon {
  opacity: 0.8;
}

.muwi-error-state__content {
  text-align: center;
}

.muwi-error-state__title {
  font-weight: var(--weight-medium);
  margin: 0 0 var(--space-2) 0;
}

.muwi-error-state__message {
  color: var(--color-text-secondary);
  margin: 0;
  font-size: var(--font-size-sm);
}

/* ==========================================================================
   Drafts List Extensions
   ========================================================================== */

.muwi-drafts-list__header {
  padding: var(--space-2) 0;
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-drafts-list__controls {
  display: flex;
  gap: var(--space-2);
  padding: var(--space-3) 0;
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-drafts-list__empty {
  padding: var(--space-8) var(--space-4);
  text-align: center;
  color: var(--color-text-tertiary);
  font-size: var(--font-size-sm);
}

/* ==========================================================================
   Long Drafts TOC Extensions
   ========================================================================== */

.muwi-longdrafts-toc {
  height: 100%;
  display: flex;
  flex-direction: column;
}

.muwi-longdrafts-toc.is-collapsed {
  width: auto;
  padding: var(--space-2);
}

.muwi-longdrafts-toc__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-3);
  border-bottom: 1px solid var(--color-border-default);
}

.muwi-longdrafts-toc__title {
  font-size: var(--font-size-sm);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-longdrafts-toc__toolbar-row {
  padding: var(--space-2) var(--space-3);
  border-bottom: 1px solid var(--color-border-subtle);
}

.muwi-longdrafts-toc__tree {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-2) 0;
}

.muwi-longdrafts-toc__empty {
  padding: var(--space-6) var(--space-4);
  text-align: center;
  color: var(--color-text-tertiary);
  font-size: var(--font-size-sm);
}

.muwi-longdrafts-toc__empty p {
  margin: 0;
}

.muwi-longdrafts-toc__empty p + p {
  margin-top: var(--space-1);
}

.muwi-longdrafts-toc__footer {
  padding: var(--space-2) var(--space-3);
  border-top: 1px solid var(--color-border-default);
  display: flex;
  justify-content: space-between;
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

.muwi-longdrafts-toc__item {
  padding: var(--space-1) var(--space-2);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: var(--space-1);
}

.muwi-longdrafts-toc__item.is-drop-target {
  background-color: var(--color-accent-subtle);
}

.muwi-longdrafts-toc__item.is-dragging {
  opacity: 0.5;
}

.muwi-longdrafts-toc__drag-handle {
  color: var(--color-text-tertiary);
  cursor: grab;
  opacity: 0;
  transition: opacity var(--duration-fast) var(--ease-default);
}

.muwi-longdrafts-toc__item:hover .muwi-longdrafts-toc__drag-handle {
  opacity: 1;
}

.muwi-longdrafts-toc__expand {
  width: 16px;
  height: 16px;
  border: none;
  background: transparent;
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: var(--color-text-tertiary);
  cursor: pointer;
  border-radius: var(--radius-xs);
  transition: var(--transition-colors);
}

.muwi-longdrafts-toc__expand:hover {
  background: var(--color-hover-overlay);
  color: var(--color-text-primary);
}

.muwi-longdrafts-toc__expand-placeholder {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
}

.muwi-longdrafts-toc__status-dot {
  width: 6px;
  height: 6px;
  border-radius: var(--radius-full);
  flex-shrink: 0;
}

.muwi-longdrafts-toc__item-label {
  flex: 1;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: var(--font-size-sm);
}

.muwi-longdrafts-toc__item-count {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
  flex-shrink: 0;
}

/* ==========================================================================
   Long Drafts Toolbar
   ========================================================================== */

.muwi-longdrafts-toolbar {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  flex-wrap: wrap;
}

.muwi-longdrafts-toolbar__group {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.muwi-longdrafts-toolbar__meta {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
}

/* ==========================================================================
   Long Drafts Settings Panel
   ========================================================================== */

.muwi-longdrafts-settings {
  padding: var(--space-4);
  display: flex;
  flex-direction: column;
  gap: var(--space-4);
}

.muwi-longdrafts-settings__copy {
  margin: 0;
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.muwi-longdrafts-settings__toggle-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-sm);
  color: var(--color-text-primary);
  cursor: pointer;
}

.muwi-longdrafts-settings__toggle-row input[type='checkbox'] {
  width: 16px;
  height: 16px;
  accent-color: var(--color-accent-default);
}

/* ==========================================================================
   Draft Editor
   ========================================================================== */

.muwi-draft-editor__toolbar {
  padding: var(--space-2) var(--space-4);
  border-top: 1px solid var(--color-border-default);
  background: var(--color-bg-primary);
}

/* ==========================================================================
   Document Switcher Modal
   ========================================================================== */

.muwi-document-switcher {
  position: fixed;
  inset: 0;
  background-color: var(--color-bg-overlay);
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: 100px;
  z-index: var(--z-modal);
}

.muwi-document-switcher__panel {
  width: 400px;
  max-height: 500px;
  background-color: var(--color-bg-elevated);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-modal);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.muwi-document-switcher__header {
  padding: var(--space-4) var(--space-5);
  border-bottom: 1px solid var(--color-border-default);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.muwi-document-switcher__title {
  margin: 0;
  font-size: var(--font-size-md);
  font-weight: var(--weight-semibold);
  color: var(--color-text-primary);
}

.muwi-document-switcher__list {
  flex: 1;
  overflow-y: auto;
}

.muwi-document-switcher__item {
  padding: var(--space-3) var(--space-5);
  border-bottom: 1px solid var(--color-border-default);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  transition: var(--transition-colors);
}

.muwi-document-switcher__item:hover {
  background-color: var(--color-bg-secondary);
}

.muwi-document-switcher__item.is-active {
  background-color: var(--color-accent-subtle);
}

.muwi-document-switcher__item-title {
  font-size: var(--font-size-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-primary);
}

.muwi-document-switcher__item-meta {
  font-size: var(--font-size-xs);
  color: var(--color-text-tertiary);
  margin-top: var(--space-0);
}

.muwi-document-switcher__footer {
  padding: var(--space-3) var(--space-5);
  border-top: 1px solid var(--color-border-default);
}
