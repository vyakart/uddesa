# MUWI Progress (Simple Status)

Last updated: February 19, 2026

## 1) Where we are now

- App development is active and stable.
- Unit tests are passing (`74` files, `304` tests).
- Latest full coverage snapshot: lines `90.82%`, statements `90.22%`, functions `86.44%`, branches `80.07%`.
- Recent focus has been adding reliable tests module by module.
- Blackboard coverage moved from almost none to strong coverage.
- Current execution stage: Phase `7.1.3` cleanup stream (repo-wide hard-coded theme color removal).

## 2) Completed tasks so far (brief)

| Task | What was done | How it was verified |
| --- | --- | --- |
| Project foundation | Vite + React + TypeScript app structure created and configured | App runs, build/test/lint scripts work |
| Core UI shell | Shared layout, modal, header, context menu, toolbar, shelf and settings flow implemented | Component tests + manual render checks |
| Data layer | Dexie database tables + query modules added for diaries and settings | Query tests for CRUD behavior |
| Diary modules (initial) | Personal Diary, Drafts, Scratchpad core flows implemented | Store tests + component behavior tests |
| Utilities (initial) | Export, backup, and citation utility foundations added | Core utility code reviewed and prepared for direct tests |
| Test wave 1 | Added tests for Drafts + Scratchpad modules and related stores | Full test run green |
| Test wave 2 | Added tests for `ErrorBoundary`, `useKeyboardShortcuts`, `useGlobalShortcuts` | Targeted tests + full run green |
| Test wave 3 | Added tests for Blackboard UI and `blackboardStore` | Targeted tests + full run green |
| Test wave 4 | Added tests for `longDraftsStore` actions, hierarchy/getters/selectors, footnotes, reorder/toggles | Targeted tests + full run green |
| Test wave 5 | Added Long Drafts UI tests for `LongDrafts`, `SectionEditor`, `TableOfContents`, `FootnoteManager`, `FocusMode` | Targeted tests + full run green |
| Test wave 6 | Added Academic tests for `academicStore`, `Academic` container, and `useCitationShortcut` | Targeted tests + full run green |
| Test wave 7 | Expanded Academic component coverage for `AcademicSectionEditor`, `CitationPicker`, and `TemplateSelector` | Targeted tests + full run green |
| Test wave 8 | Added `BibliographyManager` tests (search/select/edit/delete + DOI/BibTeX import flows) | Targeted tests + full run green |
| Test wave 9 | Added utility tests for `citation.ts`, `backup.ts`, and `export.ts` (success/failure and scheduler flows) | Utility-targeted tests + full run green + eslint green |
| Test wave 10 | Re-ran full coverage after utility tests and recorded exact project-wide numbers | Coverage report captured; global threshold failure confirmed with current percentages |
| Test wave 11 | Added panel tests for `BackupPanel` and `ExportPanel` (open/close, success/error, settings/scheduler, export options/timeout close) | Targeted panel tests + eslint + full run + coverage rerun |
| Test wave 12 | Added extension tests for `footnote.ts` (attributes, commands, and click plugin behavior) | Targeted extension tests + eslint + full run + coverage rerun |
| Test wave 13 | Expanded `export.ts` tests across PDF/DOCX routes and long-draft/academic wrappers | Targeted util tests + eslint + full run + coverage rerun |
| Test wave 14 | Expanded `citation.ts` branch coverage (fallbacks, DOI edge mapping, BibTeX fallbacks, helper edge cases) | Citation-targeted tests + eslint + full run + coverage rerun |
| Test wave 15 | Expanded `backup.ts` branch/function coverage (web fallback, restore branches, scheduler intervals, error paths, size formatting) | Backup-targeted tests + eslint + full run + coverage rerun |
| Test wave 16 | Expanded branch-heavy Drafts UI tests (`Drafts`, `DraftList`, `DraftEditor`, `StatusBadge`) | Drafts-targeted tests + eslint + full run + coverage rerun |
| Task wave 17 | Added global `usePasteHandler`, integrated it in app root, and expanded shortcut tests (special keys + cleanup) | Hook-targeted tests + app tests + full run + coverage rerun |
| Task wave 18 | Added shared editor formatting/heading shortcuts, added Personal Diary keyboard navigation/new-entry shortcuts, and resolved Academic shortcut conflict with editor focus | Editor/hook-targeted tests + diary shortcut tests + full run + coverage rerun |
| Task wave 19 | Added PBKDF2-based passkey utilities (`hashPasskey`, `verifyPasskey`, `generateSalt`, hex helpers) and wired settings passkey flows to use hashed+salted values | Crypto utility tests + settings/panel passkey tests + full run + coverage rerun |
| Task wave 20 | Added `useContentLocking` with `isLocked`, `lock`, `unlock`, `toggleLock`, and DB-backed lock refresh flow | Hook tests for lock/unlock/toggle + full run + coverage rerun |
| Task wave 21 | Added shared `PasskeyPrompt` modal component with passkey input, show/hide toggle, hint reveal button, submit/cancel actions, and inline/external error rendering | Component tests + targeted eslint + full run green |
| Task wave 22 | Added lock/unlock actions to Draft and Long Draft section context menus, passkey-setup prompting, unlock modal flow, and fixed a race in `useContentLocking.unlock` by checking DB lock state before passkey validation | Context-menu integration tests + hook regression test + targeted eslint + full run green |
| Task wave 23 | Integrated locking across Scratchpad pages/text blocks and Personal Diary entries, added store lock-update actions, enforced read-only behavior for locked content, and added per-diary unlock passkey flows | Scratchpad/PersonalDiary component+store tests + targeted eslint + full run green |
| Task wave 24 | Verified existing Excalidraw integration coverage against `3.1.1` acceptance criteria and marked task complete without redundant reimplementation | Codebase audit (`package.json`, `ExcalidrawWrapper`, blackboard tests) |
| Task wave 25 | Verified `blackboardStore` already satisfied `3.1.2` criteria (canvas/elements+viewport state, load/save/update actions, and derived index entries) and marked task complete | Store code + unit test audit (`blackboardStore.ts`, `blackboardStore.test.ts`) |
| Task wave 26 | Completed `3.1.3` viewport persistence by wiring Excalidraw `onChange` app state to `updateViewport`, loading persisted viewport into `initialData`, and extending wrapper tests | Blackboard wrapper tests + targeted eslint + full run green |
| Task wave 27 | Completed `3.2.1` click navigation from index to canvas by wiring IndexPanel navigation targets through Blackboard to Excalidraw viewport updates, with navigation lifecycle tests | Blackboard component+wrapper tests + targeted eslint + full run green |
| Task wave 28 | Verified heading detection/index derivation logic already covered `3.2.2` criteria (`#`/`##`/`###` parsing, level-based hierarchy representation, y-position sorting, and rebuild on element changes) | Store + component/test audit (`blackboardStore.ts`, `Blackboard.tsx`, `blackboardStore.test.ts`) |
| Task wave 29 | Completed `3.3.1` by adding Blackboard tool selection buttons, stroke color picker, stroke width selector, and retaining grid toggle behavior with test coverage | Blackboard toolbar tests + targeted eslint + full run green |
| Task wave 30 | Verified `3.3.2` Blackboard container criteria remained satisfied after navigation/toolbar changes (load on mount, full-height layout, toolbar/index behavior, save-on-change path) | Container + integration test audit (`Blackboard.tsx`, `Blackboard.test.tsx`) |
| Task wave 31 | Completed `3.4.1` font bundling by installing `@fontsource` packages (`Inter`, `Crimson Pro`, `Caveat`, `JetBrains Mono`) and importing them in global styles | Dependency + CSS import audit, targeted tests, full run green |
| Task wave 32 | Completed `3.4.2` by adding shared `FontSelector` (select + context-menu variants), wiring Blackboard toolbar font selection, and extending settings/defaults with `defaultFont` | New component tests + Blackboard toolbar tests + targeted eslint + full run green |
| Task wave 33 | Completed `3.4.3` by adding Blackboard right-click font context menu and integrating selected-font application/persistence in `ExcalidrawWrapper` for selected text/new text defaults | Blackboard integration tests + wrapper tests + targeted eslint + full run green |
| Task wave 34 | Completed `4.1.1` Long Drafts store acceptance by validating document/current-document state, nested section handling, and section CRUD/reorder actions against existing store implementation | `vitest src/stores/longDraftsStore.test.ts` (9 tests passing) |
| Task wave 35 | Completed `4.1.2` TableOfContents acceptance by validating auto-generated nested hierarchy, click navigation, per-section/total word counts, and adding sibling drag-and-drop reorder wired to store persistence | Long Drafts targeted sweep: `vitest src/components/diaries/long-drafts src/stores/longDraftsStore.test.ts` (32 tests passing) |
| Task wave 36 | Completed `4.1.3` SectionEditor acceptance by validating title + TipTap body editing, status updates, notes panel editing, and enabling integrated footnote insertion/management UI in-editor | Full run green: `vitest` (`67` files, `275` tests) |
| Task wave 37 | Completed `4.2.1` Footnote extension acceptance by adding marker/content attributes, auto-marker insertion, bottom footnote rendering in-editor, and click routing between markers and footnote list entries | Extension + Long Drafts sweep: `vitest src/extensions/footnote.test.ts src/components/diaries/long-drafts src/stores/longDraftsStore.test.ts` (36 tests passing) |
| Task wave 38 | Completed `4.2.2` FootnoteManager acceptance by validating list rendering, inline editing, deletion, and navigation-to-text flows, and wiring manager interactions through `SectionEditor` footnote panel actions | Component + integration tests (`FootnoteManager.test.tsx`, `SectionEditor.test.tsx`) + full run green |
| Task wave 39 | Completed `4.3.1` FocusMode acceptance by adding full-screen distraction-free overlay behavior, keyboard toggles (`Esc`, `F11`, `Cmd/Ctrl+Shift+F`), typewriter centering in focus editor scroll, and smooth overlay transitions | Long Drafts targeted tests + full run green: `vitest --run` (`67` files, `276` tests) |
| Task wave 40 | Completed `4.4.1` LongDrafts container acceptance by validating document switching modal, TOC + SectionEditor composition, focus-mode toggle presence, and explicit document metadata rendering (sections/word count/created+updated dates), plus adding Long Drafts E2E create/add/reorder flow | Integration tests + full run green (`67` files, `276` tests) + Playwright: `e2e/long-drafts.spec.ts` passing |
| Task wave 41 | Completed `5.1.1` citation-library baseline by adding direct `citeproc` dependency, bundling CSL style files (`APA`, `MLA`, `Chicago`) and locale asset, and shipping tested citeproc-backed formatting helpers for in-text citations and bibliographies | Citation-targeted tests + full run green: `vitest --run` (`68` files, `279` tests) |
| Task wave 42 | Completed `5.1.2` citation utilities by consolidating `citation.ts` with the citeproc baseline, adding `formatCitation` aliasing, preserving DOI/BibTeX helpers, and implementing full style switching (`apa7`/`mla9`/`chicago` via bundled citeproc + `harvard`/`ieee` fallback path) | Citation-targeted tests + full run green: `vitest --run` (`68` files, `280` tests) |
| Task wave 43 | Completed `5.1.3` CitationPicker phase by validating search/filter, reference selection, page-number input, citation insertion wiring, and keyboard shortcut behavior, and by consolidating shortcut handling through shared `useCitationShortcut` with case-insensitive key matching | Academic targeted tests + full run green + eslint green: `vitest --run` (`68` files, `280` tests), `eslint .` |
| Task wave 44 | Completed `5.2.1` Academic Store acceptance by verifying `papers`/`currentPaper`/`bibliographyEntries` state slices, full store CRUD flows, and citation insertion/linking actions against existing implementation and unit coverage | Store-targeted evidence + full run green + eslint green: `academicStore.test.ts`, `vitest --run` (`68` files, `280` tests), `eslint .` |
| Task wave 45 | Completed `5.2.2` BibliographyManager acceptance by implementing tag-based organization (capture/display/filter), preserving manual/DOI/BibTeX add flows, edit/delete/search flows, and extending component coverage for tag filtering behavior | Academic component-targeted tests + full run green + eslint green: `BibliographyManager.test.tsx` (`5` tests), `vitest --run` (`68` files, `281` tests), `eslint .` |
| Task wave 46 | Completed `5.2.3` ReferenceLibrary panel by introducing a separate global library panel (`ReferenceLibraryPanel`) with JSON import/export workflows and per-reference linking/unlinking to papers, then wiring it into the Academic layout | Academic targeted tests + full run green + eslint green: `ReferenceLibraryPanel.test.tsx` (`3` tests), `vitest --run` (`69` files, `284` tests), `eslint .` |
| Task wave 47 | Completed `5.3.1` AcademicSection acceptance by adding figure/table insertion with automatic numbering, cross-reference insertion panel for section/figure/table targets, and paper-format controls (line spacing, font size, margin presets) wired to paper settings | Academic editor tests + targeted suite + full run green + eslint green: `AcademicSectionEditor.test.tsx` (`5` tests), `vitest src/components/diaries/academic`, `vitest --run` (`69` files, `285` tests), `eslint .` |
| Task wave 48 | Completed `5.3.2` TemplateSelector acceptance by implementing IMRAD/custom template selection, custom section-definition input, abstract/keywords fields, author fields (multi-author add/remove), and create-paper metadata flow through `academicStore.createPaper` | Template/store/integration tests + full run green + eslint green: `TemplateSelector.test.tsx` (`3` tests), `academicStore.test.ts` (`11` tests), `Academic.test.tsx` (`5` tests), `vitest --run` (`69` files, `287` tests), `eslint .` |
| Task wave 49 | Completed `5.3.3` AcademicPaper container acceptance by validating template selection flow, section navigation, bibliography panel integration, citation style selector, and adding explicit word/character count display in the Academic toolbar, then adding E2E coverage for academic create-paper/add-reference/citation insertion workflow | Integration + E2E evidence + full run green + eslint green: `Academic.test.tsx` (`5` tests), `academic.spec.ts` passing (`1` test), `vitest --run` (`69` files, `287` tests), `playwright test e2e/academic.spec.ts`, `eslint .` |
| Task wave 50 | Completed `6.1.1` PDF export utility acceptance by confirming `jspdf` dependency usage, adding explicit PDF header/footer options, reserving content layout bands for headers/footers, preserving block-level formatting (headings/lists/blockquotes), and validating page-size option wiring | Export-targeted tests + lint green: `vitest src/utils/export.test.ts src/utils/export.pdf.test.ts` (`9` tests), `eslint src/utils/export.ts src/utils/export.pdf.test.ts` |
| Task wave 51 | Completed `6.1.2` Word export utility acceptance by applying document-wide text styling controls (font family, font size, line spacing), preserving block formatting (headings/lists/blockquotes), supporting configurable headers/footers + page numbering, and adding dedicated DOCX unit tests with mocked `docx` primitives | Export-targeted tests + lint green: `vitest src/utils/export.test.ts src/utils/export.pdf.test.ts src/utils/export.word.test.ts` (`12` tests), `eslint src/utils/export.ts src/utils/export.word.test.ts` |
| Task wave 52 | Completed `6.1.3` ExportPanel acceptance by keeping format selection for `PDF`/`DOCX`/`LaTeX`, adding format-specific options (header/footer + page numbering only for binary exports), introducing explicit export progress indicator states (`generating`/`saving`) with an accessible progressbar, and handling save-location cancellation messaging | Export panel targeted tests + lint green: `vitest src/components/common/ExportPanel/ExportPanel.test.tsx` (`5` tests), `vitest src/utils/export.test.ts src/utils/export.pdf.test.ts src/utils/export.word.test.ts src/components/common/ExportPanel/ExportPanel.test.tsx` (`17` tests), `eslint src/components/common/ExportPanel/ExportPanel.tsx src/components/common/ExportPanel/ExportPanel.test.tsx` |
| Task wave 53 | Completed `6.2.1` backup utility acceptance by validating complete table coverage in `createBackup`, strengthening backup metadata/version/date validation (`semver`, ISO timestamp, table count, total record constraints), preserving JSON export/parse flows, and confirming restore compatibility checks | Backup-targeted tests + lint green: `vitest src/utils/backup.test.ts` (`11` tests), `eslint src/utils/backup.ts src/utils/backup.test.ts` |
| Task wave 54 | Completed `6.2.2` BackupPanel acceptance by validating manual backup + restore workflows, location selector flow for automatic backups, auto-backup toggle/save behavior, and last-backup display updates after successful manual backups; added guardrail that blocks enabling auto-backup without a selected location | Backup panel tests + lint green: `vitest src/components/common/BackupPanel/BackupPanel.test.tsx` (`3` tests), `vitest src/utils/backup.test.ts src/components/common/BackupPanel/BackupPanel.test.tsx` (`14` tests), `eslint src/components/common/BackupPanel/BackupPanel.tsx src/components/common/BackupPanel/BackupPanel.test.tsx` |
| Task wave 55 | Completed `6.2.3` auto-backup acceptance by wiring scheduled saves with `maxBackups` retention policy support, enforcing backup cleanup in Electron main process for auto-backup files (`muwi-backup-*.json`), and surfacing completion notifications through `BackupPanel` auto-backup callback messaging | Backup utility + panel tests + lint green: `vitest src/utils/backup.test.ts src/components/common/BackupPanel/BackupPanel.test.tsx` (`14` tests), `eslint src/utils/backup.ts src/utils/backup.test.ts src/components/common/BackupPanel/BackupPanel.tsx src/components/common/BackupPanel/BackupPanel.test.tsx src/types/electron.ts electron/preload.ts electron/main.ts` |
| Task wave 56 | Completed Phase `7` foundation slice (`7.1.1`-`7.1.9`, `7.2.1`-`7.2.4`): created style architecture (`tokens`, `themes`, `fonts`, `reset`, `utilities`, `editor`), installed Geist font packages, wired global style import stack in `main.tsx`, added runtime theme application on `<html data-theme>`, and added theme/token tests | Targeted tests (`tokens`, `theme-switching`, `settingsStore`, `SettingsPanel`, `App`) + full run green: `vitest --run` (`73` files, `300` tests) + `eslint .` |
| Task wave 57 | Completed `7.15.0` production build boundary fix by excluding `*.test.*` from app typecheck and resolving strict TypeScript build errors in `PasskeyPrompt`, `ExcalidrawWrapper`, and `crypto` so production build path is clean again | `npm run build` green (`tsc -b && vite build`) + existing test suite/lint still green |
| Task wave 58 | Completed `7.2.5` + shared shell `7.3.1`-`7.3.7`: replaced legacy layout chrome hardcoded colors with tokenized shell styles, added `TitleBar`/`Sidebar`/`StatusBar`/`RightPanel`, refactored `DiaryLayout` to slot-based regions, extended app store with right-panel state and diary sidebar defaults, and added layout-level behavior tests | Targeted tests (`appStore`, `appRouter`, `DiaryLayout`, `NavigationHeader`) + full run + lint green: `vitest --run` (`74` files, `304` tests), `eslint .` |
| Task wave 59 | Reconciled Phase `0` with live codebase (all remaining infra criteria now verified), fixed Electron dev runtime/startup issues (`vite-plugin-electron` startup flow, `ELECTRON_RUN_AS_NODE` inheritance, ESM `__dirname` pathing), and audited partial Phase `7` items: `7.1.5` verified complete while `7.1.3` remains open due hard-coded color literals in components | Runtime checks (`npm run dev`, `npm run electron:dev` with Electron launch path active), node-typecheck (`tsc -p tsconfig.node.json`), targeted lint (`eslint vite.config.ts electron/main.ts electron/preload.ts`), and task checklist updates in `TASKS.md` |
| Task wave 60 | Completed `7.4.7` Settings modal refactor by rebuilding `SettingsPanel` into a fixed-size two-pane layout (`640x480` modal shell with `160px` nav rail), switching tab navigation to sidebar interaction styles, and migrating settings form controls/actions to shared `Button`/`FormControls` primitives while keeping behavior unchanged | Shelf/settings targeted verification: `vitest run src/components/shelf/SettingsPanel.test.tsx src/components/shelf/Shelf.test.tsx` (`9` tests passing) + targeted lint on updated shelf/settings files |
| Task wave 61 | Completed Phase `7.4.8`-`7.6.6`: finalized shared tokenized component/panel cleanup, completed shelf rebuild (`7.5.1`-`7.5.8`), completed command palette delivery (`7.6.1`-`7.6.6`), and removed non-failing React `act(...)` warnings in fake-timer shelf tests | Targeted verification: `vitest run src/components/shelf/Shelf.test.tsx src/components/shelf/SettingsPanel.test.tsx src/components/common/CommandPalette/CommandPalette.test.tsx src/hooks/useGlobalShortcuts.test.tsx` (`23` tests passing, shelf warnings cleared) |
| Task wave 62 | Completed Scratchpad UI migration `7.7.1`-`7.7.4` by moving Scratchpad onto explicit `DiaryLayout` shell slots (sidebar/toolbar/canvas/status), rebuilding sidebar page navigation with category dots + `+ New Page` footer action, implementing fixed `400x600` page canvas visuals with tokenized scratchpad styles, and adding first-use empty-state guidance and updated text-block lock/drag/focus treatments | Scratchpad-targeted verification: `vitest run src/components/diaries/scratchpad/Scratchpad.test.tsx src/components/diaries/scratchpad/ScratchpadPage.test.tsx src/components/diaries/scratchpad/PageStack.test.tsx src/components/diaries/scratchpad/CategoryPicker.test.tsx src/components/diaries/scratchpad/TextBlock.test.tsx` (`15` tests passing) + targeted lint on edited scratchpad files |
| Task wave 63 | Completed `7.8.1` Blackboard shell migration by moving Blackboard container rendering onto explicit `DiaryLayout` slots (sidebar/toolbar/canvas/status/right-panel), preserving index/canvas behaviors, and adding slot-aware component tests that keep Excalidraw integration checks intact | Blackboard-targeted verification: `vitest run src/components/diaries/blackboard/Blackboard.test.tsx` (`3` tests passing) + targeted lint on updated Blackboard files |
| Task wave 64 | Completed `7.8.2` Blackboard index/toolbar alignment by rebuilding the index sidebar with explicit heading-tree guidance copy and implementing toolbar groups for tools, stroke controls, font selector, and zoom controls per the design-system model | Blackboard-targeted verification: `vitest run src/components/diaries/blackboard` (`14` tests passing) + targeted eslint on updated blackboard component tests/files |
| Task wave 65 | Completed `7.8.3` Blackboard canvas token alignment by forcing tokenized dark canvas rendering independent of app theme, applying Blackboard token defaults for drawing/text colors, and moving grid rendering to token-colored wrapper styling keyed to viewport/grid settings | Blackboard-targeted verification: `vitest run src/components/diaries/blackboard` (`14` tests passing) + targeted eslint on `ExcalidrawWrapper` component/test updates |
| Task wave 66 | Completed `7.8.4` Blackboard status + empty-state pass by locking status copy to `Zoom: {n}%` on the left slot and adding first-use blank-canvas guidance (diary icon, headline/body, action CTA) directly in the canvas lane | Blackboard-targeted verification: `vitest run src/components/diaries/blackboard` (`15` tests passing) + targeted eslint on updated Blackboard container/tests |
| Task wave 67 | Completed `7.9.1` Personal Diary shell migration by moving Personal Diary rendering onto explicit `DiaryLayout` slots (sidebar/toolbar/canvas/status), preserving existing entry CRUD and keyboard shortcut behavior, and adding slot assertions in Personal Diary tests | Personal Diary-targeted verification: `vitest src/components/diaries/PersonalDiary/PersonalDiary.test.tsx src/components/diaries/PersonalDiary/EntryNavigation.test.tsx src/components/diaries/PersonalDiary/DiaryEntry.test.tsx` (`9` tests passing) + targeted eslint on updated Personal Diary files |
| Task wave 68 | Completed `7.9.2` Personal Diary sidebar alignment by replacing the flat list with month/year grouped sections, retaining optional mood-dot indicators per entry, and moving the `Today` action into the shell sidebar footer while preserving `loadEntry(new Date())` create-or-open behavior | Personal Diary-targeted verification: `vitest src/components/diaries/PersonalDiary` (`14` tests passing) + targeted eslint on updated Personal Diary files |
| Task wave 69 | Completed `7.9.3` Personal Diary warm-canvas and typography pass by defaulting diary canvas rendering to `--color-bg-canvas-warm` token path, setting editor line height to relaxed token scale, and constraining the formatting toolbar to `Undo`/`Redo` + `B`/`I`/`U` with font display; applied a strict token gate for all touched Personal Diary surfaces while deferring full repo-wide `7.1.3` cleanup | Personal Diary-targeted verification: `vitest src/components/diaries/PersonalDiary` (`14` tests passing) + targeted eslint on updated Personal Diary files |
| Task wave 70 | Completed `7.9.4` Personal Diary status strip + empty-state slice by switching status slots to formatted date + word/read-time metrics, adding a first-use empty-state CTA when no current entry exists, and running a strict token-gating cleanup pass on `DatePicker.tsx`; then started the broader `7.1.3` cleanup stream by removing Blackboard container hard-coded colors into tokenized shell classes | Targeted verification: `vitest src/components/diaries/PersonalDiary/PersonalDiary.test.tsx src/components/diaries/PersonalDiary/DatePicker.test.tsx src/components/diaries/blackboard/Blackboard.test.tsx` (`13` tests passing) + targeted eslint on updated component files |
| Task wave 71 | Continued dedicated `7.1.3` cleanup stream on top offenders by tokenizing theme colors in `Academic`, `BibliographyManager`, `TableOfContents`, `SectionEditor`, and `DraftList` (plus aligned DraftList test expectations), eliminating hard-coded color literals in that tranche | Tranche verification: `vitest src/components/diaries/academic src/components/diaries/long-drafts src/components/diaries/drafts/DraftList.test.tsx` (`58` tests passing), full suite `vitest --run` (`78` files, `336` tests passing), full lint `eslint .` (still blocked by pre-existing `ContextMenu` and `ToastProvider` lint errors) |

## 3) Blackboard testing progress

- New tested files:
  - `muwi/src/components/diaries/blackboard/Blackboard.test.tsx`
  - `muwi/src/components/diaries/blackboard/BlackboardToolbar.test.tsx`
  - `muwi/src/components/diaries/blackboard/ExcalidrawWrapper.test.tsx`
  - `muwi/src/components/diaries/blackboard/IndexPanel.test.tsx`
  - `muwi/src/stores/blackboardStore.test.ts`
- Coverage movement:
  - `src/components/diaries/blackboard` lines: `0.00% -> 89.21%`
  - `src/stores/blackboardStore.ts` lines: `10.95% -> 93.15%`

## 4) Current quality state

- Nothing is broken.
- Test suite is healthy and passing.
- Global coverage threshold (`80%`) is now passing.
- Current status:
  - Lines `90.82%`
  - Statements `90.22%`
  - Functions `86.44%`
  - Branches `80.07%`
- Active work is now focused on Phase `7` UI refactor slices (design system adoption and layout migration), not threshold rescue.
- Release build path is currently healthy (`npm run build` passing after `7.15.0`).

## 5) How tasks are being completed (process)

For each module, we follow the same steady flow:

1. Read the module and list key behaviors.
2. Write focused tests for user-visible behavior and store actions.
3. Run only that moduleâ€™s tests and fix issues.
4. Run full unit test suite to catch regressions.
5. Run lint for new files.
6. Record progress and move to next module.

## 6) Next steady task list

1. Continue `7.1.3` cleanup on next highest offenders (`AcademicSectionEditor`, `LongDrafts`, `TemplateSelector`, `FootnoteManager`, `CitationPicker`).
2. Resolve pre-existing repo lint blockers in `muwi/src/components/common/ContextMenu/ContextMenu.tsx` and `muwi/src/components/common/Toast/ToastProvider.tsx` so full `eslint .` is clean.
3. Move into `7.10` Drafts UI migration once the next cleanup tranche is stable and lint-clean.
